<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>allbs-excel æµ‹è¯•é¡µé¢</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
        }

        .section {
            margin-bottom: 40px;
        }

        .section-title {
            font-size: 1.8em;
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
        }

        .card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
        }

        .card h3 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 1.3em;
        }

        .card p {
            color: #666;
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .card-controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            align-items: center;
        }

        .input-group {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .input-group label {
            font-size: 0.9em;
            color: #555;
        }

        .input-group input {
            padding: 6px 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            width: 80px;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: scale(0.98);
        }

        .upload-btn {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .file-input {
            display: none;
        }

        .file-label {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            display: inline-block;
            transition: all 0.3s ease;
        }

        .file-label:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(79, 172, 254, 0.4);
        }

        .result {
            margin-top: 20px;
            padding: 15px;
            background: white;
            border-radius: 5px;
            border-left: 4px solid #667eea;
        }

        .result.success {
            border-left-color: #28a745;
            background: #d4edda;
        }

        .result.error {
            border-left-color: #dc3545;
            background: #f8d7da;
        }

        .badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 3px;
            font-size: 0.85em;
            font-weight: bold;
            margin-left: 8px;
        }

        .badge-new {
            background: #28a745;
            color: white;
        }

        .badge-advanced {
            background: #ff6b6b;
            color: white;
        }

        .import-section .card {
            background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš€ allbs-excel æµ‹è¯•å¹³å°</h1>
            <p>åŸºäº EasyExcel çš„ Spring Boot Excel å¯¼å…¥å¯¼å‡ºå¢å¼ºå·¥å…· v3.0.0</p>
        </div>

        <div class="content">
            <!-- åŸºæœ¬å¯¼å‡ºåŠŸèƒ½ -->
            <div class="section">
                <h2 class="section-title">ğŸ“¤ åŸºæœ¬å¯¼å‡ºåŠŸèƒ½</h2>
                <div class="card-grid">
                    <div class="card">
                        <h3>1. åŸºæœ¬å¯¼å‡º</h3>
                        <p>æœ€ç®€å•çš„å¯¼å‡ºæ–¹å¼ï¼Œè¿”å› List å³å¯è‡ªåŠ¨å¯¼å‡º Excel</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="simple-count" value="10" min="1" max="1000">
                            </div>
                            <button onclick="exportSimple()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>2. ç©ºæ•°æ®å¯¼å‡º <span class="badge badge-new">NEW</span></h3>
                        <p>å¯¼å‡ºåªæœ‰è¡¨å¤´çš„ç©º Excelï¼Œç”¨äºæ¨¡æ¿ä¸‹è½½</p>
                        <div class="card-controls">
                            <button onclick="exportEmpty()">å¯¼å‡ºç©ºè¡¨æ ¼</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>3. åªå¯¼å‡ºæ³¨è§£å­—æ®µ <span class="badge badge-new">NEW</span></h3>
                        <p>åªå¯¼å‡ºæ ‡æ³¨äº† @ExcelProperty çš„å­—æ®µ</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="annotated-count" value="10" min="1" max="1000">
                            </div>
                            <button onclick="exportOnlyAnnotated()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>4. å¤š Sheet å¯¼å‡º</h3>
                        <p>åœ¨ä¸€ä¸ª Excel æ–‡ä»¶ä¸­å¯¼å‡ºå¤šä¸ª Sheet</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>ç”¨æˆ·:</label>
                                <input type="number" id="multi-user" value="10" min="1" max="500">
                            </div>
                            <div class="input-group">
                                <label>è®¢å•:</label>
                                <input type="number" id="multi-order" value="20" min="1" max="500">
                            </div>
                            <button onclick="exportMultiSheet()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>5. å¤š Sheet ç©ºæ•°æ® <span class="badge badge-new">NEW</span></h3>
                        <p>å¯¼å‡ºå¤šä¸ª Sheetï¼Œæ¯ä¸ª Sheet éƒ½åªæœ‰è¡¨å¤´</p>
                        <div class="card-controls">
                            <button onclick="exportMultiSheetEmpty()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>6. åˆ—å®½å’Œè¡Œé«˜è®¾ç½®</h3>
                        <p>è‡ªå®šä¹‰åˆ—å®½å’Œè¡Œé«˜ï¼Œä¼˜åŒ–æ˜¾ç¤ºæ•ˆæœ</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="styled-count" value="15" min="1" max="1000">
                            </div>
                            <button onclick="exportStyled()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>7. åŠ¨æ€æ–‡ä»¶å</h3>
                        <p>ä½¿ç”¨ SpEL è¡¨è¾¾å¼åŠ¨æ€ç”Ÿæˆæ–‡ä»¶å</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ—¥æœŸ:</label>
                                <input type="date" id="dynamic-date" value="">
                            </div>
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="dynamic-count" value="10" min="1" max="1000">
                            </div>
                            <button onclick="exportDynamic()">å¯¼å‡º</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- é«˜çº§å¯¼å‡ºåŠŸèƒ½ -->
            <div class="section">
                <h2 class="section-title">ğŸ”¥ é«˜çº§å¯¼å‡ºåŠŸèƒ½</h2>
                <div class="card-grid">
                    <div class="card">
                        <h3>1. åˆå¹¶å•å…ƒæ ¼ <span class="badge badge-new">NEW</span></h3>
                        <p>è‡ªåŠ¨åˆå¹¶ç›¸åŒå€¼çš„å•å…ƒæ ¼ï¼Œæ”¯æŒä¾èµ–å…³ç³»åˆå¹¶</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="merge-count" value="20" min="1" max="1000">
                            </div>
                            <button onclick="exportMerge()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>2. æ•°æ®è„±æ• + å­—å…¸è½¬æ¢ <span class="badge badge-new">NEW</span></h3>
                        <p>æ”¯æŒæ‰‹æœºå·ã€èº«ä»½è¯ç­‰æ•æ„Ÿæ•°æ®è„±æ•ï¼Œå­—å…¸å€¼è‡ªåŠ¨è½¬æ¢</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="desensitize-count" value="10" min="1" max="1000">
                            </div>
                            <button onclick="exportDesensitize()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>3. å¯¼å‡ºè¿›åº¦å›è°ƒ <span class="badge badge-advanced">é«˜çº§</span></h3>
                        <p>å®æ—¶ç›‘å¬å¯¼å‡ºè¿›åº¦ï¼Œé€‚ç”¨äºå¤§æ•°æ®é‡å¯¼å‡ºï¼ˆæŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—ï¼‰</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="progress-count" value="100" min="10" max="10000">
                            </div>
                            <button onclick="exportWithProgress()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>4. å¤§æ•°æ®é‡å¯¼å‡º <span class="badge badge-advanced">é«˜çº§</span></h3>
                        <p>æµ‹è¯•å¤§æ•°æ®é‡å¯¼å‡ºæ€§èƒ½ï¼ˆæŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—ï¼‰</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="large-count" value="1000" min="100" max="50000">
                            </div>
                            <button onclick="exportLargeData()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>5. åˆå¹¶ + è¿›åº¦ <span class="badge badge-advanced">é«˜çº§</span></h3>
                        <p>åˆå¹¶å•å…ƒæ ¼åŠŸèƒ½ç»“åˆè¿›åº¦å›è°ƒ</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="merge-progress-count" value="50" min="10" max="10000">
                            </div>
                            <button onclick="exportMergeWithProgress()">å¯¼å‡º</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å¯¼å…¥åŠŸèƒ½ -->
            <div class="section import-section">
                <h2 class="section-title">ğŸ“¥ å¯¼å…¥åŠŸèƒ½æµ‹è¯•</h2>
                <div class="card-grid">
                    <div class="card">
                        <h3>1. åŸºæœ¬å¯¼å…¥</h3>
                        <p>ä¸Šä¼  Excel æ–‡ä»¶ï¼Œè‡ªåŠ¨è§£æä¸º Java å¯¹è±¡</p>
                        <div class="card-controls">
                            <input type="file" id="simple-import-file" class="file-input" accept=".xlsx,.xls">
                            <label for="simple-import-file" class="file-label">é€‰æ‹©æ–‡ä»¶</label>
                            <button class="upload-btn" onclick="importSimple()">ä¸Šä¼ å¯¼å…¥</button>
                        </div>
                        <div id="simple-import-result"></div>
                    </div>

                    <div class="card">
                        <h3>2. å¸¦éªŒè¯çš„å¯¼å…¥</h3>
                        <p>å¯¼å…¥æ—¶è‡ªåŠ¨è¿›è¡Œæ•°æ®æ ¡éªŒï¼ˆJSR-303ï¼‰</p>
                        <div class="card-controls">
                            <input type="file" id="validate-import-file" class="file-input" accept=".xlsx,.xls">
                            <label for="validate-import-file" class="file-label">é€‰æ‹©æ–‡ä»¶</label>
                            <button class="upload-btn" onclick="importValidate()">ä¸Šä¼ å¯¼å…¥</button>
                        </div>
                        <div id="validate-import-result"></div>
                    </div>

                    <div class="card">
                        <h3>3. è·³è¿‡ç©ºè¡Œå¯¼å…¥</h3>
                        <p>å¯¼å…¥æ—¶è‡ªåŠ¨è·³è¿‡ç©ºè¡Œ</p>
                        <div class="card-controls">
                            <input type="file" id="skip-import-file" class="file-input" accept=".xlsx,.xls">
                            <label for="skip-import-file" class="file-label">é€‰æ‹©æ–‡ä»¶</label>
                            <button class="upload-btn" onclick="importSkipEmpty()">ä¸Šä¼ å¯¼å…¥</button>
                        </div>
                        <div id="skip-import-result"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // è®¾ç½®é»˜è®¤æ—¥æœŸ
        document.getElementById('dynamic-date').valueAsDate = new Date();

        const API_BASE = 'http://localhost:8080';

        // å¯¼å‡ºå‡½æ•°
        function exportSimple() {
            const count = document.getElementById('simple-count').value;
            window.open(`${API_BASE}/api/export/basic/simple?count=${count}`);
        }

        function exportEmpty() {
            window.open(`${API_BASE}/api/export/basic/empty`);
        }

        function exportOnlyAnnotated() {
            const count = document.getElementById('annotated-count').value;
            window.open(`${API_BASE}/api/export/basic/only-annotated?count=${count}`);
        }

        function exportMultiSheet() {
            const userCount = document.getElementById('multi-user').value;
            const orderCount = document.getElementById('multi-order').value;
            window.open(`${API_BASE}/api/export/basic/multi-sheet?userCount=${userCount}&orderCount=${orderCount}`);
        }

        function exportMultiSheetEmpty() {
            window.open(`${API_BASE}/api/export/basic/multi-sheet-empty`);
        }

        function exportStyled() {
            const count = document.getElementById('styled-count').value;
            window.open(`${API_BASE}/api/export/basic/styled?count=${count}`);
        }

        function exportDynamic() {
            const date = document.getElementById('dynamic-date').value;
            const count = document.getElementById('dynamic-count').value;
            window.open(`${API_BASE}/api/export/basic/dynamic-name?date=${date}&count=${count}`);
        }

        function exportMerge() {
            const count = document.getElementById('merge-count').value;
            window.open(`${API_BASE}/api/export/advanced/merge?count=${count}`);
        }

        function exportDesensitize() {
            const count = document.getElementById('desensitize-count').value;
            window.open(`${API_BASE}/api/export/advanced/desensitize?count=${count}`);
        }

        function exportWithProgress() {
            const count = document.getElementById('progress-count').value;
            console.log('å¼€å§‹å¯¼å‡ºï¼Œè¯·æŸ¥çœ‹åç«¯æ§åˆ¶å°æ—¥å¿—...');
            window.open(`${API_BASE}/api/export/advanced/with-progress?count=${count}`);
        }

        function exportLargeData() {
            const count = document.getElementById('large-count').value;
            console.log('å¼€å§‹å¤§æ•°æ®é‡å¯¼å‡ºï¼Œè¯·æŸ¥çœ‹åç«¯æ§åˆ¶å°æ—¥å¿—...');
            window.open(`${API_BASE}/api/export/advanced/large-data?count=${count}`);
        }

        function exportMergeWithProgress() {
            const count = document.getElementById('merge-progress-count').value;
            console.log('å¼€å§‹å¯¼å‡ºï¼Œè¯·æŸ¥çœ‹åç«¯æ§åˆ¶å°æ—¥å¿—...');
            window.open(`${API_BASE}/api/export/advanced/merge-with-progress?count=${count}`);
        }

        // å¯¼å…¥å‡½æ•°
        function importSimple() {
            uploadFile('simple-import-file', '/api/import/simple', 'simple-import-result');
        }

        function importValidate() {
            uploadFile('validate-import-file', '/api/import/validate', 'validate-import-result');
        }

        function importSkipEmpty() {
            uploadFile('skip-import-file', '/api/import/skip-empty', 'skip-import-result');
        }

        function uploadFile(fileInputId, apiUrl, resultId) {
            const fileInput = document.getElementById(fileInputId);
            const file = fileInput.files[0];

            if (!file) {
                showResult(resultId, 'è¯·å…ˆé€‰æ‹©æ–‡ä»¶', 'error');
                return;
            }

            const formData = new FormData();
            formData.append('file', file);

            fetch(API_BASE + apiUrl, {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showResult(resultId,
                        `âœ… ${data.message}<br>å¯¼å…¥æ•°æ®é‡: ${data.count} æ¡<br>` +
                        `<pre>${JSON.stringify(data.data, null, 2)}</pre>`,
                        'success'
                    );
                } else {
                    showResult(resultId,
                        `âŒ ${data.message}<br>é”™è¯¯è¯¦æƒ…: ${data.errors.join('<br>')}`,
                        'error'
                    );
                }
            })
            .catch(error => {
                showResult(resultId, `âŒ ä¸Šä¼ å¤±è´¥: ${error.message}`, 'error');
            });
        }

        function showResult(elementId, message, type) {
            const resultDiv = document.getElementById(elementId);
            resultDiv.className = `result ${type}`;
            resultDiv.innerHTML = message;
        }
    </script>
</body>
</html>

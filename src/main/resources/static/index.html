<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>allbs-excel æµ‹è¯•é¡µé¢</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
        }

        .section {
            margin-bottom: 40px;
        }

        .section-title {
            font-size: 1.8em;
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
        }

        .card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
        }

        .card h3 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 1.3em;
        }

        .card p {
            color: #666;
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .card-controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            align-items: center;
        }

        .input-group {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .input-group label {
            font-size: 0.9em;
            color: #555;
        }

        .input-group input {
            padding: 6px 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            width: 80px;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: scale(0.98);
        }

        .upload-btn {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .file-input {
            display: none;
        }

        .file-label {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            display: inline-block;
            transition: all 0.3s ease;
        }

        .file-label:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(79, 172, 254, 0.4);
        }

        .result {
            margin-top: 20px;
            padding: 15px;
            background: white;
            border-radius: 5px;
            border-left: 4px solid #667eea;
        }

        .result.success {
            border-left-color: #28a745;
            background: #d4edda;
        }

        .result.error {
            border-left-color: #dc3545;
            background: #f8d7da;
        }

        .badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 3px;
            font-size: 0.85em;
            font-weight: bold;
            margin-left: 8px;
        }

        .badge-new {
            background: #28a745;
            color: white;
        }

        .badge-advanced {
            background: #ff6b6b;
            color: white;
        }

        .import-section .card {
            background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
        }

        /* è¿›åº¦æ¡æ ·å¼ */
        .progress-container {
            margin-top: 15px;
            display: none;
        }

        .progress-container.active {
            display: block;
        }

        .progress-bar-wrapper {
            background: #e0e0e0;
            border-radius: 10px;
            height: 24px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.85em;
            min-width: 30px;
        }

        .progress-info {
            margin-top: 8px;
            font-size: 0.9em;
            color: #666;
            display: flex;
            justify-content: space-between;
        }

        .progress-status {
            font-weight: 500;
        }

        .progress-status.success {
            color: #28a745;
        }

        .progress-status.error {
            color: #dc3545;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš€ allbs-excel æµ‹è¯•å¹³å°</h1>
            <p>åŸºäº EasyExcel çš„ Spring Boot Excel å¯¼å…¥å¯¼å‡ºå¢å¼ºå·¥å…· v3.0.0</p>
        </div>

        <div class="content">
            <!-- åŸºæœ¬å¯¼å‡ºåŠŸèƒ½ -->
            <div class="section">
                <h2 class="section-title">ğŸ“¤ åŸºæœ¬å¯¼å‡ºåŠŸèƒ½</h2>
                <div class="card-grid">
                    <div class="card">
                        <h3>1. åŸºæœ¬å¯¼å‡º</h3>
                        <p>æœ€ç®€å•çš„å¯¼å‡ºæ–¹å¼ï¼Œè¿”å› List å³å¯è‡ªåŠ¨å¯¼å‡º Excel</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="simple-count" value="10" min="1" max="1000">
                            </div>
                            <button onclick="exportSimple()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>2. ç©ºæ•°æ®å¯¼å‡º <span class="badge badge-new">NEW</span></h3>
                        <p>å¯¼å‡ºåªæœ‰è¡¨å¤´çš„ç©º Excelï¼Œç”¨äºæ¨¡æ¿ä¸‹è½½</p>
                        <div class="card-controls">
                            <button onclick="exportEmpty()">å¯¼å‡ºç©ºè¡¨æ ¼</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>3. åªå¯¼å‡ºæ³¨è§£å­—æ®µ <span class="badge badge-new">NEW</span></h3>
                        <p>åªå¯¼å‡ºæ ‡æ³¨äº† @ExcelProperty çš„å­—æ®µ</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="annotated-count" value="10" min="1" max="1000">
                            </div>
                            <button onclick="exportOnlyAnnotated()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>4. å¤š Sheet å¯¼å‡º</h3>
                        <p>åœ¨ä¸€ä¸ª Excel æ–‡ä»¶ä¸­å¯¼å‡ºå¤šä¸ª Sheet</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>ç”¨æˆ·:</label>
                                <input type="number" id="multi-user" value="10" min="1" max="500">
                            </div>
                            <div class="input-group">
                                <label>è®¢å•:</label>
                                <input type="number" id="multi-order" value="20" min="1" max="500">
                            </div>
                            <button onclick="exportMultiSheet()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>5. å¤š Sheet ç©ºæ•°æ® <span class="badge badge-new">NEW</span></h3>
                        <p>å¯¼å‡ºå¤šä¸ª Sheetï¼Œæ¯ä¸ª Sheet éƒ½åªæœ‰è¡¨å¤´</p>
                        <div class="card-controls">
                            <button onclick="exportMultiSheetEmpty()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>6. åˆ—å®½å’Œè¡Œé«˜è®¾ç½®</h3>
                        <p>è‡ªå®šä¹‰åˆ—å®½å’Œè¡Œé«˜ï¼Œä¼˜åŒ–æ˜¾ç¤ºæ•ˆæœ</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="styled-count" value="15" min="1" max="1000">
                            </div>
                            <button onclick="exportStyled()">å¯¼å‡º</button>
                        </div>
                    </div>

                </div>
            </div>

            <!-- é«˜çº§å¯¼å‡ºåŠŸèƒ½ -->
            <div class="section">
                <h2 class="section-title">ğŸ”¥ é«˜çº§å¯¼å‡ºåŠŸèƒ½</h2>
                <div class="card-grid">
                    <div class="card">
                        <h3>1. åˆå¹¶å•å…ƒæ ¼ <span class="badge badge-new">NEW</span></h3>
                        <p>è‡ªåŠ¨åˆå¹¶ç›¸åŒå€¼çš„å•å…ƒæ ¼ï¼Œæ”¯æŒä¾èµ–å…³ç³»åˆå¹¶</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="merge-count" value="20" min="1" max="1000">
                            </div>
                            <button onclick="exportMerge()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>2. æ•°æ®è„±æ• + å­—å…¸è½¬æ¢ <span class="badge badge-new">NEW</span></h3>
                        <p>æ”¯æŒæ‰‹æœºå·ã€èº«ä»½è¯ç­‰æ•æ„Ÿæ•°æ®è„±æ•ï¼Œå­—å…¸å€¼è‡ªåŠ¨è½¬æ¢</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="desensitize-count" value="10" min="1" max="1000">
                            </div>
                            <button onclick="exportDesensitize()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>3. å¯¼å‡ºè¿›åº¦å›è°ƒ <span class="badge badge-advanced">é«˜çº§</span></h3>
                        <p>å®æ—¶ç›‘å¬å¯¼å‡ºè¿›åº¦ï¼Œé€‚ç”¨äºå¤§æ•°æ®é‡å¯¼å‡º</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="progress-count" value="5000" min="100" max="50000" step="100">
                            </div>
                            <button onclick="exportWithProgress()">å¯¼å‡º</button>
                        </div>
                        <!-- å®æ—¶è¿›åº¦å±•ç¤º -->
                        <div id="progress-with-progress" class="progress-container">
                            <div class="progress-bar-wrapper">
                                <div class="progress-bar" style="width: 0%">0%</div>
                            </div>
                            <div class="progress-info">
                                <span class="progress-status">å‡†å¤‡ä¸­...</span>
                                <span class="progress-detail">0/0</span>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <h3>4. å¤§æ•°æ®é‡å¯¼å‡º <span class="badge badge-advanced">é«˜çº§</span></h3>
                        <p>æµ‹è¯•å¤§æ•°æ®é‡å¯¼å‡ºæ€§èƒ½ï¼Œå®æ—¶æ˜¾ç¤ºè¿›åº¦</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="large-count" value="20000" min="1000" max="100000" step="1000">
                            </div>
                            <button onclick="exportLargeData()">å¯¼å‡º</button>
                        </div>
                        <!-- å®æ—¶è¿›åº¦å±•ç¤º -->
                        <div id="progress-large-data" class="progress-container">
                            <div class="progress-bar-wrapper">
                                <div class="progress-bar" style="width: 0%">0%</div>
                            </div>
                            <div class="progress-info">
                                <span class="progress-status">å‡†å¤‡ä¸­...</span>
                                <span class="progress-detail">0/0</span>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <h3>5. åˆå¹¶ + è¿›åº¦ <span class="badge badge-advanced">é«˜çº§</span></h3>
                        <p>åˆå¹¶å•å…ƒæ ¼åŠŸèƒ½ç»“åˆè¿›åº¦å›è°ƒ</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="merge-progress-count" value="3000" min="100" max="30000" step="100">
                            </div>
                            <button onclick="exportMergeWithProgress()">å¯¼å‡º</button>
                        </div>
                        <!-- å®æ—¶è¿›åº¦å±•ç¤º -->
                        <div id="progress-merge-progress" class="progress-container">
                            <div class="progress-bar-wrapper">
                                <div class="progress-bar" style="width: 0%">0%</div>
                            </div>
                            <div class="progress-info">
                                <span class="progress-status">å‡†å¤‡ä¸­...</span>
                                <span class="progress-detail">0/0</span>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <h3>6. Excel å…¬å¼ <span class="badge badge-new">NEW</span></h3>
                        <p>æ”¯æŒå•å…ƒæ ¼å…¬å¼è‡ªåŠ¨è®¡ç®—ï¼ˆ=B*Cï¼‰</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="formula-count" value="10" min="1" max="1000">
                            </div>
                            <button onclick="exportFormula()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>7. å†»ç»“çª—æ ¼ + ç­›é€‰ <span class="badge badge-new">NEW</span></h3>
                        <p>å†»ç»“é¦–è¡Œã€è‡ªåŠ¨ç­›é€‰ã€åˆ—å®½è®¾ç½®</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="sheet-style-count" value="20" min="1" max="1000">
                            </div>
                            <button onclick="exportSheetStyle()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>8. æ¡ä»¶æ ¼å¼ï¼ˆå›¾æ ‡é›†ï¼‰ <span class="badge badge-new">NEW</span></h3>
                        <p>æ ¹æ®æ•°å€¼è‡ªåŠ¨æ˜¾ç¤ºå›¾æ ‡ï¼ˆçº¢ç»¿ç¯ã€ç®­å¤´ã€æ——å¸œï¼‰</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="conditional-format-count" value="15" min="1" max="1000">
                            </div>
                            <button onclick="exportConditionalFormat()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>9. å¯¼å…¥æ¨¡æ¿ç”Ÿæˆ <span class="badge badge-new">NEW</span></h3>
                        <p>ç”ŸæˆåŒ…å«ç¤ºä¾‹æ•°æ®çš„å¯¼å…¥æ¨¡æ¿</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>ç¤ºä¾‹è¡Œæ•°:</label>
                                <input type="number" id="template-samples" value="3" min="0" max="10">
                            </div>
                            <button onclick="exportTemplate()">ä¸‹è½½æ¨¡æ¿</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>10. Excel åŠ å¯† <span class="badge badge-new">NEW</span></h3>
                        <p>ä¸¤ç§åŠ å¯†æ–¹å¼ï¼šç®€å•å¯†ç ä¿æŠ¤ & AGILEé«˜çº§åŠ å¯†</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="encrypted-count" value="20" min="1" max="1000">
                            </div>
                        </div>
                        <div class="card-controls" style="margin-top: 10px;">
                            <button onclick="exportEncrypted()" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                                ğŸ”’ ç®€å•åŠ å¯† (password123)
                            </button>
                            <button onclick="exportEncryptedAdvanced()" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                                ğŸ” AGILE é«˜çº§åŠ å¯†
                            </button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ’¡ <strong>ç®€å•åŠ å¯†</strong>: ä½¿ç”¨ @ExportExcel password å±æ€§ï¼Œå¯†ç å›ºå®šä¸º password123<br>
                            ğŸ’¡ <strong>AGILEåŠ å¯†</strong>: ä½¿ç”¨ ExcelEncryptionUtilï¼Œå¯†ç ä¸º password123ï¼Œæ›´å®‰å…¨
                        </p>
                    </div>

                </div>
            </div>

            <!-- å­—å…¸è½¬æ¢ç¤ºä¾‹ -->
            <div class="section">
                <h2 class="section-title">ğŸ“– å­—å…¸è½¬æ¢ç¤ºä¾‹</h2>
                <div class="card-grid">
                    <div class="card">
                        <h3>1. å¯¼å‡ºå­—å…¸è½¬æ¢ <span class="badge badge-new">NEW</span></h3>
                        <p>æ•°æ®åº“å€¼(0/1/2) â†’ Excelæ ‡ç­¾(å¥³/ç”·/æœªçŸ¥)</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="dict-export-count" value="10" min="1" max="100">
                            </div>
                            <button onclick="exportDictExample()">å¯¼å‡ºç¤ºä¾‹</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>2. ä¸‹è½½å­—å…¸æ¨¡æ¿ <span class="badge badge-new">NEW</span></h3>
                        <p>ä¸‹è½½åŒ…å«å­—å…¸è½¬æ¢ç¤ºä¾‹çš„æ¨¡æ¿æ–‡ä»¶</p>
                        <div class="card-controls">
                            <button onclick="downloadDictTemplate()">ä¸‹è½½æ¨¡æ¿</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>3. å¯¼å…¥å­—å…¸è½¬æ¢ <span class="badge badge-new">NEW</span></h3>
                        <p>Excelæ ‡ç­¾(å¥³/ç”·/æœªçŸ¥) â†’ æ•°æ®åº“å€¼(0/1/2)</p>
                        <div class="card-controls">
                            <input type="file" id="dict-import-file" class="file-input" accept=".xlsx,.xls">
                            <label for="dict-import-file" class="file-label">é€‰æ‹©æ–‡ä»¶</label>
                            <button class="upload-btn" onclick="importDictExample()">ä¸Šä¼ å¯¼å…¥</button>
                        </div>
                        <div id="dict-import-result"></div>
                    </div>

                    <div class="card">
                        <h3>4. æŸ¥çœ‹å­—å…¸é…ç½® <span class="badge badge-new">NEW</span></h3>
                        <p>æŸ¥çœ‹ç³»ç»Ÿä¸­é…ç½®çš„æ‰€æœ‰å­—å…¸</p>
                        <div class="card-controls">
                            <button onclick="viewDictConfig()">æŸ¥çœ‹é…ç½®</button>
                        </div>
                        <div id="dict-config-result"></div>
                    </div>
                </div>
            </div>

            <!-- å¯¼å…¥åŠŸèƒ½ -->
            <div class="section import-section">
                <h2 class="section-title">ğŸ“¥ å¯¼å…¥åŠŸèƒ½æµ‹è¯•</h2>
                <div class="card-grid">
                    <div class="card">
                        <h3>0. ä¸‹è½½å¯¼å…¥æ¨¡æ¿ <span class="badge badge-new">NEW</span></h3>
                        <p>ä¸‹è½½æ ‡å‡†æ ¼å¼çš„å¯¼å…¥æ¨¡æ¿ï¼ˆåŒ…å«ç¤ºä¾‹æ•°æ®ï¼‰</p>
                        <div class="card-controls">
                            <button onclick="downloadTemplate()">ä¸‹è½½æ¨¡æ¿</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>1. åŸºæœ¬å¯¼å…¥</h3>
                        <p>ä¸Šä¼  Excel æ–‡ä»¶ï¼Œè‡ªåŠ¨è§£æä¸º Java å¯¹è±¡</p>
                        <div class="card-controls">
                            <input type="file" id="simple-import-file" class="file-input" accept=".xlsx,.xls">
                            <label for="simple-import-file" class="file-label">é€‰æ‹©æ–‡ä»¶</label>
                            <button class="upload-btn" onclick="importSimple()">ä¸Šä¼ å¯¼å…¥</button>
                        </div>
                        <div id="simple-import-result"></div>
                    </div>

                    <div class="card">
                        <h3>2. å¸¦éªŒè¯çš„å¯¼å…¥</h3>
                        <p>å¯¼å…¥æ—¶è‡ªåŠ¨è¿›è¡Œæ•°æ®æ ¡éªŒï¼ˆJSR-303ï¼‰</p>
                        <div class="card-controls">
                            <input type="file" id="validate-import-file" class="file-input" accept=".xlsx,.xls">
                            <label for="validate-import-file" class="file-label">é€‰æ‹©æ–‡ä»¶</label>
                            <button class="upload-btn" onclick="importValidate()">ä¸Šä¼ å¯¼å…¥</button>
                        </div>
                        <div id="validate-import-result"></div>
                    </div>

                    <div class="card">
                        <h3>3. è·³è¿‡ç©ºè¡Œå¯¼å…¥</h3>
                        <p>å¯¼å…¥æ—¶è‡ªåŠ¨è·³è¿‡ç©ºè¡Œ</p>
                        <div class="card-controls">
                            <input type="file" id="skip-import-file" class="file-input" accept=".xlsx,.xls">
                            <label for="skip-import-file" class="file-label">é€‰æ‹©æ–‡ä»¶</label>
                            <button class="upload-btn" onclick="importSkipEmpty()">ä¸Šä¼ å¯¼å…¥</button>
                        </div>
                        <div id="skip-import-result"></div>
                    </div>
                </div>
            </div>

            <!-- å›¾ç‰‡å¯¼å…¥å¯¼å‡ºåŠŸèƒ½ -->
            <div class="section">
                <h2 class="section-title">ğŸ–¼ï¸ å›¾ç‰‡å¯¼å…¥å¯¼å‡º <span class="badge badge-new">NEW</span></h2>
                <div class="card-grid">
                    <div class="card">
                        <h3>1. å¯¼å‡ºå¸¦å›¾ç‰‡çš„Excel <span class="badge badge-hot">æ¨è</span></h3>
                        <p>æ”¯æŒåœ¨Excelä¸­åµŒå…¥å›¾ç‰‡ï¼Œè‡ªåŠ¨è°ƒæ•´å°ºå¯¸ï¼Œé˜²æ­¢å‹ç¼©å˜å½¢</p>
                        <div class="card-controls">
                            <button onclick="exportProductImages()">å¯¼å‡ºå•†å“å›¾ç‰‡</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ’¡ æ”¯æŒï¼šä¸»å›¾(120x120)ã€ç¼©ç•¥å›¾(80x80)ã€å›¾é›†(100x100)
                        </p>
                    </div>

                    <div class="card">
                        <h3>2. ä¸‹è½½å›¾ç‰‡å¯¼å…¥æ¨¡æ¿</h3>
                        <p>ä¸‹è½½åŒ…å«ç¤ºä¾‹å›¾ç‰‡çš„Excelæ¨¡æ¿ï¼Œç”¨äºæµ‹è¯•å¯¼å…¥åŠŸèƒ½</p>
                        <div class="card-controls">
                            <button onclick="downloadImageTemplate()">ä¸‹è½½æ¨¡æ¿</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>3. å¯¼å…¥å¸¦å›¾ç‰‡çš„Excel</h3>
                        <p>ä¸Šä¼ Excelæ–‡ä»¶ï¼Œè‡ªåŠ¨è§£æå›¾ç‰‡æ•°æ®ï¼ˆæ”¯æŒBase64ã€å­—èŠ‚æ•°ç»„ï¼‰</p>
                        <div class="card-controls">
                            <input type="file" id="image-import-file" class="file-input" accept=".xlsx,.xls">
                            <label for="image-import-file" class="file-label">é€‰æ‹©æ–‡ä»¶</label>
                            <button class="upload-btn" onclick="importProductImages()">ä¸Šä¼ å¯¼å…¥</button>
                        </div>
                        <div id="image-import-result"></div>
                    </div>

                    <div class="card">
                        <h3>4. å›¾ç‰‡å°ºå¯¸æ§åˆ¶è¯´æ˜</h3>
                        <p>é€šè¿‡ @ExcelImage æ³¨è§£ç²¾ç¡®æ§åˆ¶å›¾ç‰‡åœ¨Excelä¸­çš„æ˜¾ç¤ºå°ºå¯¸</p>
                        <div class="card-controls">
                            <button onclick="showImageSizeGuide()">æŸ¥çœ‹è¯´æ˜</button>
                        </div>
                        <div id="image-size-guide" style="display:none; margin-top:15px; padding:15px; background:#f0f0f0; border-radius:5px; font-size:0.9em;">
                            <h4 style="margin-bottom:10px;">ğŸ“ å›¾ç‰‡å°ºå¯¸é…ç½®ç¤ºä¾‹ï¼š</h4>
                            <pre style="background:white; padding:10px; border-radius:5px; overflow-x:auto;">
@ExcelProperty("å•†å“ä¸»å›¾")
@ExcelImage(width = 120, height = 120)
private String mainImage;

@ExcelProperty("ç¼©ç•¥å›¾")
@ExcelImage(width = 80, height = 80)
private byte[] thumbnail;

@ExcelProperty("å›¾é›†")
@ExcelImage(width = 100, height = 100)
private List&lt;String&gt; imageList;</pre>
                            <p style="margin-top:10px; color:#666;">
                                âœ… æ”¯æŒè‡ªå®šä¹‰å®½é«˜ï¼ˆåƒç´ ï¼‰<br>
                                âœ… è‡ªåŠ¨è°ƒæ•´è¡Œé«˜å’Œåˆ—å®½<br>
                                âœ… é˜²æ­¢å›¾ç‰‡è¢«å‹ç¼©å˜å½¢<br>
                                âœ… æ”¯æŒå•å¼ æˆ–å¤šå¼ å›¾ç‰‡
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å›¾è¡¨å¯¼å‡ºåŠŸèƒ½ -->
            <div class="section">
                <h2 class="section-title">ğŸ“Š Excel å›¾è¡¨å¯¼å‡º <span class="badge badge-new">NEW</span></h2>
                <p class="section-description">æ”¯æŒ 6 ç§å›¾è¡¨ç±»å‹ï¼Œé€šè¿‡æ³¨è§£é…ç½® X/Y è½´ã€æ ‡é¢˜ã€å›¾ä¾‹ç­‰æ‰€æœ‰ç»˜åˆ¶å› ç´ </p>
                <div class="card-grid">
                    <div class="card">
                        <h3>1. æŠ˜çº¿å›¾ <span class="badge badge-hot">æ¨è</span></h3>
                        <p>å±•ç¤ºæ•°æ®éšæ—¶é—´çš„å˜åŒ–è¶‹åŠ¿ï¼Œé€‚åˆé”€å”®è¶‹åŠ¿ã€æ¸©åº¦å˜åŒ–ç­‰</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æœˆä»½æ•°:</label>
                                <input type="number" id="line-chart-months" value="12" min="3" max="12">
                            </div>
                            <button onclick="exportLineChart()">å¯¼å‡ºæŠ˜çº¿å›¾</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ“ˆ åŒ…å« 3 æ¡çº¿ï¼šSalesã€Costã€Profit
                        </p>
                    </div>

                    <div class="card">
                        <h3>2. æŸ±çŠ¶å›¾ï¼ˆçºµå‘ï¼‰</h3>
                        <p>æ¯”è¾ƒä¸åŒç±»åˆ«çš„æ•°æ®ï¼Œé€‚åˆé”€å”®å¯¹æ¯”ã€æˆæœ¬åˆ†æç­‰</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æœˆä»½æ•°:</label>
                                <input type="number" id="column-chart-months" value="12" min="3" max="12">
                            </div>
                            <button onclick="exportColumnChart()">å¯¼å‡ºæŸ±çŠ¶å›¾</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ“Š å¯¹æ¯”ï¼šSales vs Cost
                        </p>
                    </div>

                    <div class="card">
                        <h3>3. æ¡å½¢å›¾ï¼ˆæ¨ªå‘ï¼‰</h3>
                        <p>æ¨ªå‘å±•ç¤ºï¼Œé€‚åˆéƒ¨é—¨å¯¹æ¯”ã€äº§å“é”€é‡æ’è¡Œç­‰</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æœˆä»½æ•°:</label>
                                <input type="number" id="bar-chart-months" value="12" min="3" max="12">
                            </div>
                            <button onclick="exportBarChart()">å¯¼å‡ºæ¡å½¢å›¾</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ“‰ åˆ†æï¼šMonthly Profit
                        </p>
                    </div>

                    <div class="card">
                        <h3>4. é¥¼å›¾</h3>
                        <p>å±•ç¤ºå„éƒ¨åˆ†å æ€»ä½“çš„æ¯”ä¾‹ï¼Œé€‚åˆå¸‚åœºä»½é¢ã€é”€å”®å æ¯”ç­‰</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æœˆä»½æ•°:</label>
                                <input type="number" id="pie-chart-months" value="12" min="3" max="12">
                            </div>
                            <button onclick="exportPieChart()">å¯¼å‡ºé¥¼å›¾</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ¥§ æ˜¾ç¤ºï¼šSales Distribution
                        </p>
                    </div>

                    <div class="card">
                        <h3>5. é¢ç§¯å›¾</h3>
                        <p>å±•ç¤ºæ•°é‡éšæ—¶é—´çš„ç´¯ç§¯å˜åŒ–ï¼Œé€‚åˆç´¯è®¡é”€å”®é¢ã€ç”¨æˆ·å¢é•¿ç­‰</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æœˆä»½æ•°:</label>
                                <input type="number" id="area-chart-months" value="12" min="3" max="12">
                            </div>
                            <button onclick="exportAreaChart()">å¯¼å‡ºé¢ç§¯å›¾</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ“ ç´¯è®¡ï¼šSales & Cost
                        </p>
                    </div>

                    <div class="card">
                        <h3>6. æ•£ç‚¹å›¾</h3>
                        <p>å±•ç¤ºä¸¤ä¸ªå˜é‡çš„ç›¸å…³æ€§ï¼Œé€‚åˆæ•°æ®åˆ†å¸ƒã€ç›¸å…³æ€§åˆ†æç­‰</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æœˆä»½æ•°:</label>
                                <input type="number" id="scatter-chart-months" value="12" min="3" max="12">
                            </div>
                            <button onclick="exportScatterChart()">å¯¼å‡ºæ•£ç‚¹å›¾</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            âš« ç›¸å…³æ€§ï¼šSales vs Cost
                        </p>
                    </div>

                    <div class="card">
                        <h3>7. å¤šç³»åˆ—å›¾è¡¨</h3>
                        <p>ä¸€ä¸ªå›¾è¡¨æ˜¾ç¤ºå¤šä¸ªæ•°æ®ç³»åˆ—ï¼Œå®Œæ•´å±•ç¤ºè´¢åŠ¡æ•°æ®</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æœˆä»½æ•°:</label>
                                <input type="number" id="multi-chart-months" value="12" min="3" max="12">
                            </div>
                            <button onclick="exportMultiSeriesChart()">å¯¼å‡ºå¤šç³»åˆ—</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ“Š åŒ…å«ï¼šSalesã€Costã€Profit
                        </p>
                    </div>

                    <div class="card">
                        <h3>8. è‡ªå®šä¹‰å°ºå¯¸å›¾è¡¨</h3>
                        <p>è‡ªå®šä¹‰å›¾è¡¨ä½ç½®å’Œå¤§å°ï¼Œæ¼”ç¤ºå¤§å°ºå¯¸å›¾è¡¨æ•ˆæœ</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æœˆä»½æ•°:</label>
                                <input type="number" id="custom-chart-months" value="12" min="3" max="12">
                            </div>
                            <button onclick="exportCustomPositionChart()">å¯¼å‡ºå¤§å›¾è¡¨</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ–¼ï¸ å¤§å°ºå¯¸æ˜¾ç¤º
                        </p>
                    </div>
                </div>

                <!-- å›¾è¡¨é…ç½®è¯´æ˜ -->
                <div class="card" style="margin-top: 20px;">
                    <h3>ğŸ“‹ å›¾è¡¨é…ç½®è¯´æ˜</h3>
                    <button onclick="toggleChartGuide()" style="margin-bottom: 15px;">æŸ¥çœ‹é…ç½®ç¤ºä¾‹</button>
                    <div id="chart-guide" style="display:none;">
                        <div style="background:#f8f9fa; padding:20px; border-radius:8px; margin-top:15px;">
                            <h4 style="color:#2196F3; margin-bottom:15px;">âœ¨ é€šè¿‡æ³¨è§£å®Œæ•´æ§åˆ¶å›¾è¡¨</h4>
                            <pre style="background:white; padding:15px; border-radius:5px; overflow-x:auto; font-size:0.9em;">@ExportExcel(
    name = "é”€å”®è¶‹åŠ¿å›¾è¡¨",
    chart = @ExcelChart(
        <span style="color:#e91e63">title</span> = "Monthly Sales Trend",      // å›¾è¡¨æ ‡é¢˜
        <span style="color:#e91e63">enabled</span> = true,                     // æ˜¯å¦å¯ç”¨
        <span style="color:#e91e63">type</span> = ChartType.LINE,              // å›¾è¡¨ç±»å‹ âœ…
        <span style="color:#e91e63">xAxisField</span> = "Month",               // X è½´å­—æ®µ âœ…
        <span style="color:#e91e63">yAxisFields</span> = {"Sales", "Cost"},    // Y è½´å­—æ®µ âœ…
        <span style="color:#e91e63">startRow</span> = 0, <span style="color:#e91e63">startColumn</span> = 8,   // å›¾è¡¨ä½ç½®
        <span style="color:#e91e63">endRow</span> = 20, <span style="color:#e91e63">endColumn</span> = 18,
        <span style="color:#e91e63">xAxisTitle</span> = "æœˆä»½",                // X è½´æ ‡é¢˜ âœ…
        <span style="color:#e91e63">yAxisTitle</span> = "é‡‘é¢",                // Y è½´æ ‡é¢˜ âœ…
        <span style="color:#e91e63">showLegend</span> = true,                  // æ˜¾ç¤ºå›¾ä¾‹ âœ…
        <span style="color:#e91e63">legendPosition</span> = LegendPosition.BOTTOM  // å›¾ä¾‹ä½ç½® âœ…
    )
)</pre>
                            <div style="margin-top:20px; display:grid; grid-template-columns: repeat(2, 1fr); gap:15px;">
                                <div>
                                    <h5 style="color:#4CAF50; margin-bottom:8px;">ğŸ“Š æ”¯æŒçš„å›¾è¡¨ç±»å‹</h5>
                                    <ul style="font-size:0.9em; line-height:1.8;">
                                        <li>âœ… LINE - æŠ˜çº¿å›¾</li>
                                        <li>âœ… COLUMN - æŸ±çŠ¶å›¾ï¼ˆçºµå‘ï¼‰</li>
                                        <li>âœ… BAR - æ¡å½¢å›¾ï¼ˆæ¨ªå‘ï¼‰</li>
                                        <li>âœ… PIE - é¥¼å›¾</li>
                                        <li>âœ… AREA - é¢ç§¯å›¾</li>
                                        <li>âœ… SCATTER - æ•£ç‚¹å›¾</li>
                                    </ul>
                                </div>
                                <div>
                                    <h5 style="color:#4CAF50; margin-bottom:8px;">ğŸ¯ é…ç½®è¦ç‚¹</h5>
                                    <ul style="font-size:0.9em; line-height:1.8;">
                                        <li>âœ… xAxisField å¯¹åº”è¡¨å¤´åˆ—å</li>
                                        <li>âœ… yAxisFields æ”¯æŒå¤šä¸ªç³»åˆ—</li>
                                        <li>âœ… å­—æ®µåæ”¯æŒå¿½ç•¥å¤§å°å†™</li>
                                        <li>âœ… å›¾ä¾‹ä½ç½®ï¼šTOP/BOTTOM/LEFT/RIGHT</li>
                                        <li>âœ… å›¾è¡¨ä½ç½®å’Œå°ºå¯¸å¯è‡ªå®šä¹‰</li>
                                        <li>âœ… æ”¯æŒä¸­è‹±æ–‡æ ‡é¢˜å’Œå­—æ®µå</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- åµŒå¥—å¯¹è±¡å¯¼å‡ºåŠŸèƒ½ -->
            <div class="section">
                <h2 class="section-title">ğŸ†• åµŒå¥—å¯¹è±¡å¯¼å‡ºåŠŸèƒ½ <span class="badge badge-new">NEW</span></h2>
                <div class="card-grid">
                    <div class="card">
                        <h3>1. @NestedProperty - åµŒå¥—å¯¹è±¡å­—æ®µæå–</h3>
                        <p>ä»åµŒå¥—å¯¹è±¡ã€é›†åˆã€Map ä¸­æå–æŒ‡å®šå­—æ®µå€¼å¯¼å‡º</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="nested-property-count" value="10" min="1" max="100">
                            </div>
                            <button onclick="exportNestedProperty()">å¯¼å‡º</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ’¡ æ¼”ç¤ºï¼šæå–éƒ¨é—¨åç§°ã€é¢†å¯¼ç”µè¯ã€æŠ€èƒ½åˆ—è¡¨ã€Mapä¸­çš„åŸå¸‚ç­‰
                        </p>
                    </div>

                    <div class="card">
                        <h3>2. @FlattenProperty - åµŒå¥—å¯¹è±¡è‡ªåŠ¨å±•å¼€</h3>
                        <p>è‡ªåŠ¨å±•å¼€åµŒå¥—å¯¹è±¡çš„æ‰€æœ‰ @ExcelProperty å­—æ®µ</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="flatten-property-count" value="10" min="1" max="100">
                            </div>
                            <button onclick="exportFlattenProperty()">å¯¼å‡º</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ’¡ æ¼”ç¤ºï¼šè‡ªåŠ¨å±•å¼€éƒ¨é—¨å¯¹è±¡çš„æ‰€æœ‰å­—æ®µï¼Œæ”¯æŒå‰ç¼€å’Œé€’å½’å±•å¼€
                        </p>
                    </div>

                    <div class="card">
                        <h3>3. @FlattenList - è®¢å•æ˜ç»†å±•å¼€</h3>
                        <p>å°†è®¢å•çš„ List&lt;OrderItem&gt; å±•å¼€ä¸ºå¤šè¡Œï¼Œè‡ªåŠ¨åˆå¹¶å•å…ƒæ ¼</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>è®¢å•æ•°:</label>
                                <input type="number" id="flatten-list-order-count" value="5" min="1" max="20">
                            </div>
                            <button onclick="exportFlattenListOrder()">å¯¼å‡º</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ’¡ æ¼”ç¤ºï¼šä¸€ä¸ªè®¢å•æœ‰å¤šä¸ªå•†å“æ˜ç»†ï¼Œå±•å¼€ä¸ºå¤šè¡Œå¹¶è‡ªåŠ¨åˆå¹¶
                        </p>
                    </div>

                    <div class="card">
                        <h3>4. @FlattenList - å­¦ç”Ÿå¤š List å±•å¼€</h3>
                        <p>å­¦ç”Ÿæœ‰å¤šä¸ªè¯¾ç¨‹å’Œå¤šä¸ªå¥–é¡¹ï¼Œå±•å¼€ä¸ºå¤šè¡Œï¼ˆå–æœ€é•¿ç­–ç•¥ï¼‰</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>å­¦ç”Ÿæ•°:</label>
                                <input type="number" id="flatten-list-student-count" value="5" min="1" max="20">
                            </div>
                            <button onclick="exportFlattenListStudent()">å¯¼å‡º</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ’¡ æ¼”ç¤ºï¼šå¤šä¸ª List å­—æ®µåŒæ—¶å±•å¼€ï¼ŒæŒ‰æœ€é•¿ List çš„é•¿åº¦å±•å¼€
                        </p>
                    </div>

                    <div class="card">
                        <h3>5. @ConditionalStyle - æ¡ä»¶æ ·å¼</h3>
                        <p>æ ¹æ®å•å…ƒæ ¼å€¼è‡ªåŠ¨åº”ç”¨ä¸åŒæ ·å¼ï¼ˆé¢œè‰²ã€å­—ä½“ç­‰ï¼‰</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="conditional-style-count" value="20" min="1" max="100">
                            </div>
                            <button onclick="exportConditionalStyle()">å¯¼å‡º</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ’¡ æ¼”ç¤ºï¼šåˆ†æ•°>=90ç»¿è‰²ã€>=60é»„è‰²ã€<60çº¢è‰²ï¼›çŠ¶æ€ä¸åŒé¢œè‰²
                        </p>
                    </div>

                    <div class="card">
                        <h3>6. @DynamicHeaders - åŠ¨æ€è¡¨å¤´</h3>
                        <p>æ ¹æ®æ•°æ®åŠ¨æ€ç”Ÿæˆè¡¨å¤´åˆ—ï¼ˆé€‚ç”¨äºå±æ€§ä¸å›ºå®šçš„åœºæ™¯ï¼‰</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="dynamic-header-count" value="15" min="1" max="100">
                            </div>
                            <button onclick="exportDynamicHeader()">å¯¼å‡º</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ’¡ æ¼”ç¤ºï¼šä¸åŒäº§å“ç±»åˆ«æœ‰ä¸åŒå±æ€§ï¼Œè¡¨å¤´è‡ªåŠ¨ç”Ÿæˆ
                        </p>
                    </div>
                </div>
            </div>

            <!-- è¡Œå·å’ŒåŠ¨æ€æ–‡ä»¶ååŠŸèƒ½ -->
            <div class="section">
                <h2 class="section-title">ğŸ”¢ è¡Œå·ä¸åŠ¨æ€æ–‡ä»¶å <span class="badge badge-new">NEW</span></h2>
                <div class="card-grid">
                    <div class="card">
                        <h3>1. @ExcelLine - è‡ªåŠ¨è¡Œå·</h3>
                        <p>ä½¿ç”¨ @ExcelLine æ³¨è§£ä¸ºå¯¼å‡ºæ•°æ®è‡ªåŠ¨æ·»åŠ è¡Œå·</p>
                        <div class="card-controls">
                            <label>æ•°æ®æ¡æ•°:</label>
                            <div class="input-group">
                                <input type="number" id="row-number-count" value="50" min="10" max="500" step="10">
                            </div>
                            <button onclick="exportRowNumber()">å¯¼å‡ºå¸¦è¡Œå·</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ’¡ æ¼”ç¤ºï¼šæ¯è¡Œæ•°æ®è‡ªåŠ¨ç”Ÿæˆåºå·ï¼Œæ— éœ€æ‰‹åŠ¨èµ‹å€¼
                        </p>
                    </div>

                    <div class="card">
                        <h3>2. åŠ¨æ€æ–‡ä»¶å - SpELè¡¨è¾¾å¼</h3>
                        <p>æ”¯æŒ #{#today}, #{#now}, #{#å‚æ•°å} ç­‰è¡¨è¾¾å¼</p>
                        <div class="card-controls">
                            <label>ç”¨æˆ·å:</label>
                            <div class="input-group">
                                <input type="text" id="dynamic-username" value="admin" placeholder="è¾“å…¥ç”¨æˆ·å">
                            </div>
                            <label>æ•°æ®æ¡æ•°:</label>
                            <div class="input-group">
                                <input type="number" id="dynamic-count" value="20" min="5" max="100">
                            </div>
                            <button onclick="exportDynamicFilename()">å¯¼å‡º(æ—¥æœŸ+ç”¨æˆ·å)</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ’¡ æ–‡ä»¶åæ ¼å¼: UserList-20251120-admin.xlsx
                        </p>
                    </div>

                    <div class="card">
                        <h3>3. åŠ¨æ€æ–‡ä»¶å - æ—¶é—´æˆ³</h3>
                        <p>ä½¿ç”¨æ—¶é—´æˆ³ä½œä¸ºæ–‡ä»¶åï¼Œç¡®ä¿å”¯ä¸€æ€§</p>
                        <div class="card-controls">
                            <label>æ•°æ®æ¡æ•°:</label>
                            <div class="input-group">
                                <input type="number" id="timestamp-count" value="30" min="5" max="100">
                            </div>
                            <button onclick="exportTimestampFilename()">å¯¼å‡º(æ—¶é—´æˆ³)</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ’¡ æ–‡ä»¶åæ ¼å¼: ExportData-1732067123456.xlsx
                        </p>
                    </div>

                    <div class="card">
                        <h3>4. åŠ¨æ€æ–‡ä»¶å - æ–¹æ³•å‚æ•°</h3>
                        <p>ä½¿ç”¨æ–¹æ³•å‚æ•°å€¼åŠ¨æ€ç”Ÿæˆæ–‡ä»¶å</p>
                        <div class="card-controls">
                            <label>éƒ¨é—¨åç§°:</label>
                            <div class="input-group">
                                <input type="text" id="dept-name" value="Tech" placeholder="è¾“å…¥éƒ¨é—¨åç§°(è‹±æ–‡)">
                            </div>
                            <label>æ•°æ®æ¡æ•°:</label>
                            <div class="input-group">
                                <input type="number" id="dept-count" value="25" min="5" max="100">
                            </div>
                            <button onclick="exportParamFilename()">å¯¼å‡º(éƒ¨é—¨+æ—¥æœŸæ—¶é—´)</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ’¡ æ–‡ä»¶åæ ¼å¼: Tech-Employees-20251120-153045.xlsx
                        </p>
                    </div>
                </div>
            </div>

            <!-- åµŒå¥—å¯¹è±¡å¯¼å…¥åŠŸèƒ½ -->
            <div class="section">
                <h2 class="section-title">ğŸ“¥ åµŒå¥—å¯¹è±¡å¯¼å…¥åŠŸèƒ½ <span class="badge badge-new">NEW</span></h2>
                <div class="card-grid">
                    <div class="card">
                        <h3>1. @NestedProperty - åµŒå¥—å¯¹è±¡å¯¼å…¥</h3>
                        <p>å¯¼å…¥Excelæ—¶è‡ªåŠ¨å¡«å……åµŒå¥—å¯¹è±¡å­—æ®µ</p>
                        <div class="card-controls">
                            <input type="file" id="nested-property-import-file" class="file-input" accept=".xlsx,.xls">
                            <label for="nested-property-import-file" class="file-label">é€‰æ‹©æ–‡ä»¶</label>
                            <button class="upload-btn" onclick="importNestedProperty()">ä¸Šä¼ å¯¼å…¥</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ’¡ å…ˆå¯¼å‡ºä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åå¯ä»¥å°è¯•å¯¼å…¥
                        </p>
                        <div id="nested-property-import-result" style="margin-top: 10px;"></div>
                    </div>

                    <div class="card">
                        <h3>2. @FlattenList - å¤šè¡Œèšåˆå¯¼å…¥</h3>
                        <p>å°†å¤šè¡Œæ˜ç»†æ•°æ®èšåˆå›Listå¯¹è±¡</p>
                        <div class="card-controls">
                            <input type="file" id="flatten-list-import-file" class="file-input" accept=".xlsx,.xls">
                            <label for="flatten-list-import-file" class="file-label">é€‰æ‹©æ–‡ä»¶</label>
                            <button class="upload-btn" onclick="importFlattenListOrder()">ä¸Šä¼ å¯¼å…¥</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ’¡ å…ˆå¯¼å‡ºè®¢å•æ˜ç»†ï¼Œç„¶åå¯¼å…¥æµ‹è¯•èšåˆåŠŸèƒ½
                        </p>
                        <div id="flatten-list-import-result" style="margin-top: 10px;"></div>
                    </div>
                </div>
            </div>

            <!-- æ•°æ®éªŒè¯åŠŸèƒ½ -->
            <div class="section">
                <h2 class="section-title">âœ… æ•°æ®éªŒè¯åŠŸèƒ½ <span class="badge badge-new">NEW</span></h2>
                <div class="card-grid">
                    <div class="card">
                        <h3>1. @ExcelValidation - åŸºç¡€æ•°æ®éªŒè¯</h3>
                        <p>ä¸º Excel åˆ—æ·»åŠ æ•°æ®éªŒè¯è§„åˆ™ï¼ˆä¸‹æ‹‰åˆ—è¡¨ã€æ•°å€¼èŒƒå›´ã€æ—¥æœŸã€æ–‡æœ¬é•¿åº¦ç­‰ï¼‰</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="validation-count" value="10" min="1" max="100">
                            </div>
                            <button onclick="exportValidation()">å¯¼å‡º</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ’¡ æ¼”ç¤ºï¼šæ€§åˆ«ä¸‹æ‹‰ã€å¹´é¾„èŒƒå›´18-65ã€å·¥èµ„èŒƒå›´ã€æ—¥æœŸéªŒè¯ã€æ–‡æœ¬é•¿åº¦ç­‰
                        </p>
                    </div>

                    <div class="card">
                        <h3>2. @ExcelValidation - è‡ªå®šä¹‰éªŒè¯èŒƒå›´</h3>
                        <p>è‡ªå®šä¹‰æ•°æ®éªŒè¯çš„è¡ŒèŒƒå›´ï¼ˆé€‚ç”¨äºä¸åŒä¸šåŠ¡åœºæ™¯ï¼‰</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="validation-custom-count" value="10" min="1" max="100">
                            </div>
                            <button onclick="exportValidationCustom()">å¯¼å‡º</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ’¡ æ¼”ç¤ºï¼šéªŒè¯èŒƒå›´ä»ç¬¬2è¡Œåˆ°ç¬¬1000è¡Œï¼ˆæ”¯æŒå¤§æ•°æ®é‡ï¼‰
                        </p>
                    </div>
                </div>
            </div>

            <!-- å¤š Sheet å…³è”å¯¼å‡ºåŠŸèƒ½ -->
            <div class="section">
                <h2 class="section-title">ğŸ”— å¤š Sheet å…³è”å¯¼å‡º <span class="badge badge-new">NEW</span></h2>
                <div class="card-grid">
                    <div class="card">
                        <h3>1. @RelatedSheet - å…³è” Sheet å¯¼å‡º</h3>
                        <p>å°†ä¸»è¡¨å’Œå…³è”æ˜ç»†å¯¼å‡ºåˆ°ä¸åŒ Sheetï¼Œè‡ªåŠ¨å»ºç«‹å…³è”å…³ç³»</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>è®¢å•æ•°:</label>
                                <input type="number" id="multi-sheet-count" value="5" min="1" max="20">
                            </div>
                            <button onclick="exportMultiSheet()">å¯¼å‡º</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ’¡ æ¼”ç¤ºï¼šè®¢å•ä¸»è¡¨å’Œè®¢å•æ˜ç»†åˆ†åˆ«å¯¼å‡ºåˆ°ä¸åŒ Sheetï¼Œå¹¶åˆ›å»ºå…³è”
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // è®¾ç½®é»˜è®¤æ—¥æœŸ
        document.getElementById('dynamic-date').valueAsDate = new Date();

        const API_BASE = 'http://localhost:8080';

        // ==================== SSE è¿›åº¦ç®¡ç† ====================

        let activeEventSources = {}; // å­˜å‚¨æ´»è·ƒçš„ SSE è¿æ¥

        /**
         * åˆ›å»º SSE è¿æ¥ç›‘å¬è¿›åº¦
         * @param {string} progressId - è¿›åº¦å®¹å™¨çš„ ID
         * @param {string} sessionId - ä¼šè¯ ID
         */
        function connectProgress(progressId, sessionId) {
            const progressContainer = document.getElementById(progressId);
            const progressBar = progressContainer.querySelector('.progress-bar');
            const progressStatus = progressContainer.querySelector('.progress-status');
            const progressDetail = progressContainer.querySelector('.progress-detail');

            // æ˜¾ç¤ºè¿›åº¦å®¹å™¨
            progressContainer.classList.add('active');

            // é‡ç½®è¿›åº¦
            progressBar.style.width = '0%';
            progressBar.textContent = '0%';
            progressStatus.textContent = 'è¿æ¥ä¸­...';
            progressStatus.className = 'progress-status';
            progressDetail.textContent = '0/0';

            // æ ‡è®°æ˜¯å¦å·²å®Œæˆï¼ˆç”¨äºåŒºåˆ†æ­£å¸¸å…³é—­å’Œé”™è¯¯ï¼‰
            let isCompleted = false;
            let isError = false;

            // å…³é—­ä¹‹å‰çš„è¿æ¥ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
            if (activeEventSources[sessionId]) {
                activeEventSources[sessionId].close();
            }

            // åˆ›å»ºæ–°çš„ SSE è¿æ¥
            const eventSource = new EventSource(`${API_BASE}/api/progress/subscribe/${sessionId}`);
            activeEventSources[sessionId] = eventSource;

            eventSource.addEventListener('progress', function(event) {
                const data = JSON.parse(event.data);

                switch(data.type) {
                    case 'start':
                        progressStatus.textContent = 'å¼€å§‹å¯¼å‡º...';
                        progressStatus.className = 'progress-status';
                        progressDetail.textContent = `0/${data.totalRows}`;
                        break;

                    case 'progress':
                        const percentage = Math.round(data.percentage);
                        progressBar.style.width = percentage + '%';
                        progressBar.textContent = percentage + '%';
                        progressStatus.textContent = 'å¯¼å‡ºä¸­...';
                        progressStatus.className = 'progress-status';
                        progressDetail.textContent = `${data.currentRow}/${data.totalRows}`;
                        break;

                    case 'complete':
                        isCompleted = true;
                        progressBar.style.width = '100%';
                        progressBar.textContent = '100%';
                        progressStatus.textContent = 'âœ“ å¯¼å‡ºå®Œæˆ';
                        progressStatus.className = 'progress-status success';
                        progressDetail.textContent = `${data.totalRows}/${data.totalRows}`;

                        // ä¸»åŠ¨å…³é—­è¿æ¥ï¼Œé¿å…åç«¯å…³é—­æ—¶è§¦å‘ onerror
                        setTimeout(() => {
                            eventSource.close();
                            delete activeEventSources[sessionId];
                        }, 2000);

                        // 3ç§’åéšè—è¿›åº¦æ¡
                        setTimeout(() => {
                            progressContainer.classList.remove('active');
                        }, 3000);
                        break;

                    case 'error':
                        isError = true;
                        progressStatus.textContent = 'âœ— å¯¼å‡ºå¤±è´¥: ' + data.message;
                        progressStatus.className = 'progress-status error';

                        // å…³é—­è¿æ¥
                        eventSource.close();
                        delete activeEventSources[sessionId];

                        // 5ç§’åéšè—è¿›åº¦æ¡
                        setTimeout(() => {
                            progressContainer.classList.remove('active');
                        }, 5000);
                        break;
                }
            });

            eventSource.onerror = function(error) {
                // å¦‚æœå·²ç»å®Œæˆæˆ–å·²ç»å¤„ç†äº†é”™è¯¯ï¼Œä¸å†æ˜¾ç¤ºé”™è¯¯æç¤º
                if (isCompleted || isError) {
                    console.log('SSE è¿æ¥æ­£å¸¸å…³é—­');
                    eventSource.close();
                    delete activeEventSources[sessionId];
                    return;
                }

                // çœŸæ­£çš„è¿æ¥é”™è¯¯
                console.error('SSE è¿æ¥é”™è¯¯:', error);
                progressStatus.textContent = 'âœ— è¿æ¥å¤±è´¥';
                progressStatus.className = 'progress-status error';
                eventSource.close();
                delete activeEventSources[sessionId];

                // 5ç§’åéšè—è¿›åº¦æ¡
                setTimeout(() => {
                    progressContainer.classList.remove('active');
                }, 5000);
            };
        }

        /**
         * ç”Ÿæˆå”¯ä¸€çš„ä¼šè¯ ID
         */
        function generateSessionId() {
            return 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }

        // å¯¼å‡ºå‡½æ•°
        function exportSimple() {
            const count = document.getElementById('simple-count').value;
            window.open(`${API_BASE}/api/export/basic/simple?count=${count}`);
        }

        function exportEmpty() {
            window.open(`${API_BASE}/api/export/basic/empty`);
        }

        function exportOnlyAnnotated() {
            const count = document.getElementById('annotated-count').value;
            window.open(`${API_BASE}/api/export/basic/only-annotated?count=${count}`);
        }

        function exportMultiSheet() {
            const userCount = document.getElementById('multi-user').value;
            const orderCount = document.getElementById('multi-order').value;
            window.open(`${API_BASE}/api/export/basic/multi-sheet?userCount=${userCount}&orderCount=${orderCount}`);
        }

        function exportMultiSheetEmpty() {
            window.open(`${API_BASE}/api/export/basic/multi-sheet-empty`);
        }

        function exportStyled() {
            const count = document.getElementById('styled-count').value;
            window.open(`${API_BASE}/api/export/basic/styled?count=${count}`);
        }

        function exportDynamic() {
            const date = document.getElementById('dynamic-date').value;
            const count = document.getElementById('dynamic-count').value;
            window.open(`${API_BASE}/api/export/basic/dynamic-name?date=${date}&count=${count}`);
        }

        // ä¸‹è½½å¯¼å…¥æ¨¡æ¿
        function downloadTemplate() {
            window.open(`${API_BASE}/api/import/template`);
        }

        function exportMerge() {
            const count = document.getElementById('merge-count').value;
            window.open(`${API_BASE}/api/export/advanced/merge?count=${count}`);
        }

        function exportDesensitize() {
            const count = document.getElementById('desensitize-count').value;
            window.open(`${API_BASE}/api/export/advanced/desensitize?count=${count}`);
        }

        function exportWithProgress() {
            const count = document.getElementById('progress-count').value;
            const sessionId = generateSessionId();

            // å»ºç«‹ SSE è¿æ¥ç›‘å¬è¿›åº¦
            connectProgress('progress-with-progress', sessionId);

            // æ‰“å¼€å¯¼å‡ºé“¾æ¥ï¼ˆå¸¦ä¸Š sessionIdï¼‰
            window.open(`${API_BASE}/api/export/advanced/with-progress?count=${count}&sessionId=${sessionId}`);
        }

        function exportLargeData() {
            const count = document.getElementById('large-count').value;
            const sessionId = generateSessionId();

            // å»ºç«‹ SSE è¿æ¥ç›‘å¬è¿›åº¦
            connectProgress('progress-large-data', sessionId);

            // æ‰“å¼€å¯¼å‡ºé“¾æ¥ï¼ˆå¸¦ä¸Š sessionIdï¼‰
            window.open(`${API_BASE}/api/export/advanced/large-data?count=${count}&sessionId=${sessionId}`);
        }

        function exportMergeWithProgress() {
            const count = document.getElementById('merge-progress-count').value;
            const sessionId = generateSessionId();

            // å»ºç«‹ SSE è¿æ¥ç›‘å¬è¿›åº¦
            connectProgress('progress-merge-progress', sessionId);

            // æ‰“å¼€å¯¼å‡ºé“¾æ¥ï¼ˆå¸¦ä¸Š sessionIdï¼‰
            window.open(`${API_BASE}/api/export/advanced/merge-with-progress?count=${count}&sessionId=${sessionId}`);
        }

        // å¯¼å…¥å‡½æ•°
        function importSimple() {
            uploadFile('simple-import-file', '/api/import/simple', 'simple-import-result');
        }

        function importValidate() {
            uploadFile('validate-import-file', '/api/import/validate', 'validate-import-result');
        }

        function importSkipEmpty() {
            uploadFile('skip-import-file', '/api/import/skip-empty', 'skip-import-result');
        }

        // å­—å…¸è½¬æ¢ç¤ºä¾‹å‡½æ•°
        function exportDictExample() {
            const count = document.getElementById('dict-export-count').value;
            window.open(`${API_BASE}/api/dict/export?count=${count}`);
        }

        function downloadDictTemplate() {
            window.open(`${API_BASE}/api/dict/template`);
        }

        function importDictExample() {
            uploadFile('dict-import-file', '/api/dict/import', 'dict-import-result');
        }

        function viewDictConfig() {
            fetch(`${API_BASE}/api/dict/config`)
                .then(response => response.json())
                .then(data => {
                    let html = '<div class="result-content">';
                    html += '<h4>å­—å…¸é…ç½®ä¿¡æ¯ï¼š</h4>';
                    html += '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
                    html += '</div>';
                    document.getElementById('dict-config-result').innerHTML = html;
                })
                .catch(error => {
                    showResult('dict-config-result', 'è·å–å­—å…¸é…ç½®å¤±è´¥: ' + error.message, 'error');
                });
        }

        function uploadFile(fileInputId, apiUrl, resultId) {
            const fileInput = document.getElementById(fileInputId);
            const file = fileInput.files[0];

            if (!file) {
                showResult(resultId, 'è¯·å…ˆé€‰æ‹©æ–‡ä»¶', 'error');
                return;
            }

            const formData = new FormData();
            formData.append('file', file);

            fetch(API_BASE + apiUrl, {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showResult(resultId,
                        `âœ… ${data.message}<br>å¯¼å…¥æ•°æ®é‡: ${data.count} æ¡<br>` +
                        `<pre>${JSON.stringify(data.data, null, 2)}</pre>`,
                        'success'
                    );
                } else {
                    showResult(resultId,
                        `âŒ ${data.message}<br>é”™è¯¯è¯¦æƒ…: ${data.errors.join('<br>')}`,
                        'error'
                    );
                }
            })
            .catch(error => {
                showResult(resultId, `âŒ ä¸Šä¼ å¤±è´¥: ${error.message}`, 'error');
            });
        }

        function showResult(elementId, message, type) {
            const resultDiv = document.getElementById(elementId);
            resultDiv.className = `result ${type}`;
            resultDiv.innerHTML = message;
        }

        // ==================== åµŒå¥—å¯¹è±¡å¯¼å‡ºå‡½æ•° ====================

        function exportNestedProperty() {
            const count = document.getElementById('nested-property-count').value;
            window.open(`${API_BASE}/api/export/nested/nested-property?count=${count}`);
        }

        function exportFlattenProperty() {
            const count = document.getElementById('flatten-property-count').value;
            window.open(`${API_BASE}/api/export/nested/flatten-property?count=${count}`);
        }

        function exportFlattenListOrder() {
            const count = document.getElementById('flatten-list-order-count').value;
            window.open(`${API_BASE}/api/export/nested/flatten-list-order?count=${count}`);
        }

        function exportFlattenListStudent() {
            const count = document.getElementById('flatten-list-student-count').value;
            window.open(`${API_BASE}/api/export/nested/flatten-list-student?count=${count}`);
        }

        function exportConditionalStyle() {
            const count = document.getElementById('conditional-style-count').value;
            window.open(`${API_BASE}/api/export/nested/conditional-style?count=${count}`);
        }

        function exportDynamicHeader() {
            const count = document.getElementById('dynamic-header-count').value;
            window.open(`${API_BASE}/api/export/nested/dynamic-header?count=${count}`);
        }

        // å¯¼å…¥å‡½æ•°
        function importNestedProperty() {
            const fileInput = document.getElementById('nested-property-import-file');
            const resultDiv = document.getElementById('nested-property-import-result');

            if (!fileInput.files || fileInput.files.length === 0) {
                resultDiv.innerHTML = '<p style="color: red;">è¯·å…ˆé€‰æ‹©æ–‡ä»¶</p>';
                return;
            }

            const formData = new FormData();
            formData.append('file', fileInput.files[0]);

            resultDiv.innerHTML = '<p style="color: blue;">å¯¼å…¥ä¸­...</p>';

            fetch(`${API_BASE}/api/import/nested/nested-property`, {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    resultDiv.innerHTML = `
                        <p style="color: green;">âœ“ ${data.message}</p>
                        <pre style="max-height: 200px; overflow: auto; font-size: 0.85em;">${JSON.stringify(data.data, null, 2)}</pre>
                    `;
                } else {
                    resultDiv.innerHTML = `<p style="color: red;">âœ— å¯¼å…¥å¤±è´¥ï¼š${data.message}</p>`;
                }
            })
            .catch(error => {
                resultDiv.innerHTML = `<p style="color: red;">âœ— å¯¼å…¥å¤±è´¥ï¼š${error.message}</p>`;
            });
        }

        function importFlattenListOrder() {
            const fileInput = document.getElementById('flatten-list-import-file');
            const resultDiv = document.getElementById('flatten-list-import-result');

            if (!fileInput.files || fileInput.files.length === 0) {
                resultDiv.innerHTML = '<p style="color: red;">è¯·å…ˆé€‰æ‹©æ–‡ä»¶</p>';
                return;
            }

            const formData = new FormData();
            formData.append('file', fileInput.files[0]);

            resultDiv.innerHTML = '<p style="color: blue;">å¯¼å…¥ä¸­...</p>';

            fetch(`${API_BASE}/api/import/nested/flatten-list-order`, {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    resultDiv.innerHTML = `
                        <p style="color: green;">âœ“ ${data.message}</p>
                        <pre style="max-height: 200px; overflow: auto; font-size: 0.85em;">${JSON.stringify(data.data, null, 2)}</pre>
                    `;
                } else {
                    resultDiv.innerHTML = `<p style="color: red;">âœ— å¯¼å…¥å¤±è´¥ï¼š${data.message}</p>`;
                }
            })
            .catch(error => {
                resultDiv.innerHTML = `<p style="color: red;">âœ— å¯¼å…¥å¤±è´¥ï¼š${error.message}</p>`;
            });
        }

        // æ•°æ®éªŒè¯å¯¼å‡ºå‡½æ•°
        function exportValidation() {
            const count = document.getElementById('validation-count').value;
            window.location.href = `${API_BASE}/api/export/advanced/validation?count=${count}`;
        }

        function exportValidationCustom() {
            const count = document.getElementById('validation-custom-count').value;
            window.location.href = `${API_BASE}/api/export/advanced/validation-custom?count=${count}`;
        }

        // å¤š Sheet å…³è”å¯¼å‡ºå‡½æ•°
        function exportMultiSheet() {
            const count = document.getElementById('multi-sheet-count').value;
            window.location.href = `${API_BASE}/api/export/advanced/multi-sheet?count=${count}`;
        }

        // ==================== æ–°åŠŸèƒ½å¯¼å‡ºå‡½æ•° ====================

        // Excel å…¬å¼å¯¼å‡º
        function exportFormula() {
            const count = document.getElementById('formula-count').value;
            window.location.href = `${API_BASE}/api/export/advanced/formula?count=${count}`;
        }

        // å†»ç»“çª—æ ¼å’Œç­›é€‰å¯¼å‡º
        function exportSheetStyle() {
            const count = document.getElementById('sheet-style-count').value;
            window.location.href = `${API_BASE}/api/export/advanced/sheet-style?count=${count}`;
        }

        // æ¡ä»¶æ ¼å¼å¯¼å‡º
        function exportConditionalFormat() {
            const count = document.getElementById('conditional-format-count').value;
            window.location.href = `${API_BASE}/api/export/advanced/conditional-format?count=${count}`;
        }

        // å¯¼å…¥æ¨¡æ¿ç”Ÿæˆ
        function exportTemplate() {
            const sampleRows = document.getElementById('template-samples').value;
            window.location.href = `${API_BASE}/api/export/advanced/template?sampleRows=${sampleRows}`;
        }

        // Excel å›¾è¡¨å¯¼å‡ºï¼ˆæ—§ç‰ˆï¼‰
        function exportChart() {
            const count = document.getElementById('chart-count').value;
            window.location.href = `${API_BASE}/api/export/advanced/chart?count=${count}`;
        }

        // Excel åŠ å¯†å¯¼å‡º - ç®€å•åŠ å¯†ï¼ˆä½¿ç”¨ @ExportExcel password å±æ€§ï¼‰
        function exportEncrypted() {
            const count = document.getElementById('encrypted-count').value;
            window.location.href = `${API_BASE}/api/export/advanced/encrypted?count=${count}`;
        }

        // Excel åŠ å¯†å¯¼å‡º - AGILE é«˜çº§åŠ å¯†ï¼ˆä½¿ç”¨ ExcelEncryptionUtilï¼‰
        function exportEncryptedAdvanced() {
            const count = document.getElementById('encrypted-count').value;
            window.location.href = `${API_BASE}/api/export/advanced/encrypted-advanced?count=${count}&password=password123`;
        }

        // ========== è¡Œå·å’ŒåŠ¨æ€æ–‡ä»¶ååŠŸèƒ½ ==========

        // @ExcelLine - è‡ªåŠ¨è¡Œå·å¯¼å‡º
        function exportRowNumber() {
            const count = document.getElementById('row-number-count').value;
            window.location.href = `${API_BASE}/api/export/advanced/row-number?count=${count}`;
        }

        // åŠ¨æ€æ–‡ä»¶å - SpELè¡¨è¾¾å¼
        function exportDynamicFilename() {
            const username = document.getElementById('dynamic-username').value;
            const count = document.getElementById('dynamic-count').value;
            window.location.href = `${API_BASE}/api/export/advanced/dynamic-filename?username=${encodeURIComponent(username)}&count=${count}`;
        }

        // åŠ¨æ€æ–‡ä»¶å - æ—¶é—´æˆ³
        function exportTimestampFilename() {
            const count = document.getElementById('timestamp-count').value;
            window.location.href = `${API_BASE}/api/export/advanced/dynamic-filename-timestamp?count=${count}`;
        }

        // åŠ¨æ€æ–‡ä»¶å - æ–¹æ³•å‚æ•°
        function exportParamFilename() {
            const department = document.getElementById('dept-name').value;
            const count = document.getElementById('dept-count').value;
            window.location.href = `${API_BASE}/api/export/advanced/dynamic-filename-param?department=${encodeURIComponent(department)}&count=${count}`;
        }

        // ========== å›¾ç‰‡å¯¼å…¥å¯¼å‡ºåŠŸèƒ½ ==========

        // å¯¼å‡ºå¸¦å›¾ç‰‡çš„å•†å“Excel
        function exportProductImages() {
            window.location.href = `${API_BASE}/api/image/export`;
        }

        // ä¸‹è½½å›¾ç‰‡å¯¼å…¥æ¨¡æ¿
        function downloadImageTemplate() {
            window.location.href = `${API_BASE}/api/image/template`;
        }

        // å¯¼å…¥å¸¦å›¾ç‰‡çš„Excel
        function importProductImages() {
            const fileInput = document.getElementById('image-import-file');
            const resultDiv = document.getElementById('image-import-result');

            if (!fileInput.files.length) {
                resultDiv.innerHTML = '<p style="color: orange;">âš  è¯·å…ˆé€‰æ‹©æ–‡ä»¶</p>';
                return;
            }

            const formData = new FormData();
            formData.append('file', fileInput.files[0]);

            resultDiv.innerHTML = '<p style="color: blue;">â³ æ­£åœ¨å¯¼å…¥...</p>';

            fetch(`${API_BASE}/api/image/import`, {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    resultDiv.innerHTML = `
                        <p style="color: green;">âœ“ ${data.message}</p>
                        <p style="font-size: 0.9em; margin-top: 5px;">
                            æˆåŠŸå¯¼å…¥ ${data.count} æ¡è®°å½•
                        </p>
                        <details style="margin-top: 10px;">
                            <summary style="cursor: pointer; color: #667eea;">æŸ¥çœ‹å¯¼å…¥è¯¦æƒ…</summary>
                            <pre style="max-height: 300px; overflow: auto; font-size: 0.85em; background: #f8f9fa; padding: 10px; border-radius: 5px; margin-top: 10px;">${JSON.stringify(data.products, null, 2)}</pre>
                        </details>
                    `;
                } else {
                    resultDiv.innerHTML = `<p style="color: red;">âœ— å¯¼å…¥å¤±è´¥ï¼š${data.message}</p>`;
                }
            })
            .catch(error => {
                resultDiv.innerHTML = `<p style="color: red;">âœ— å¯¼å…¥å¤±è´¥ï¼š${error.message}</p>`;
            });
        }

        // æ˜¾ç¤º/éšè—å›¾ç‰‡å°ºå¯¸è¯´æ˜
        function showImageSizeGuide() {
            const guideDiv = document.getElementById('image-size-guide');
            if (guideDiv.style.display === 'none') {
                guideDiv.style.display = 'block';
            } else {
                guideDiv.style.display = 'none';
            }
        }

        // ========== å›¾è¡¨å¯¼å‡ºåŠŸèƒ½ ==========

        // 1. å¯¼å‡ºæŠ˜çº¿å›¾
        function exportLineChart() {
            const months = document.getElementById('line-chart-months').value;
            window.location.href = `${API_BASE}/api/chart/line?months=${months}`;
        }

        // 2. å¯¼å‡ºæŸ±çŠ¶å›¾
        function exportColumnChart() {
            const months = document.getElementById('column-chart-months').value;
            window.location.href = `${API_BASE}/api/chart/column?months=${months}`;
        }

        // 3. å¯¼å‡ºæ¡å½¢å›¾
        function exportBarChart() {
            const months = document.getElementById('bar-chart-months').value;
            window.location.href = `${API_BASE}/api/chart/bar?months=${months}`;
        }

        // 4. å¯¼å‡ºé¥¼å›¾
        function exportPieChart() {
            const months = document.getElementById('pie-chart-months').value;
            window.location.href = `${API_BASE}/api/chart/pie?months=${months}`;
        }

        // 5. å¯¼å‡ºé¢ç§¯å›¾
        function exportAreaChart() {
            const months = document.getElementById('area-chart-months').value;
            window.location.href = `${API_BASE}/api/chart/area?months=${months}`;
        }

        // 6. å¯¼å‡ºæ•£ç‚¹å›¾
        function exportScatterChart() {
            const months = document.getElementById('scatter-chart-months').value;
            window.location.href = `${API_BASE}/api/chart/scatter?months=${months}`;
        }

        // 7. å¯¼å‡ºå¤šç³»åˆ—å›¾è¡¨
        function exportMultiSeriesChart() {
            const months = document.getElementById('multi-chart-months').value;
            window.location.href = `${API_BASE}/api/chart/multi-series?months=${months}`;
        }

        // 8. å¯¼å‡ºè‡ªå®šä¹‰ä½ç½®å›¾è¡¨
        function exportCustomPositionChart() {
            const months = document.getElementById('custom-chart-months').value;
            window.location.href = `${API_BASE}/api/chart/custom-position?months=${months}`;
        }

        // åˆ‡æ¢å›¾è¡¨é…ç½®è¯´æ˜
        function toggleChartGuide() {
            const guideDiv = document.getElementById('chart-guide');
            if (guideDiv.style.display === 'none') {
                guideDiv.style.display = 'block';
            } else {
                guideDiv.style.display = 'none';
            }
        }
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>allbs-excel æµ‹è¯•é¡µé¢</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
        }

        .section {
            margin-bottom: 40px;
        }

        .section-title {
            font-size: 1.8em;
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
        }

        .card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
        }

        .card h3 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 1.3em;
        }

        .card p {
            color: #666;
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .card-controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            align-items: center;
        }

        .input-group {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .input-group label {
            font-size: 0.9em;
            color: #555;
        }

        .input-group input {
            padding: 6px 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            width: 80px;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: scale(0.98);
        }

        .upload-btn {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .file-input {
            display: none;
        }

        .file-label {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            display: inline-block;
            transition: all 0.3s ease;
        }

        .file-label:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(79, 172, 254, 0.4);
        }

        .result {
            margin-top: 20px;
            padding: 15px;
            background: white;
            border-radius: 5px;
            border-left: 4px solid #667eea;
        }

        .result.success {
            border-left-color: #28a745;
            background: #d4edda;
        }

        .result.error {
            border-left-color: #dc3545;
            background: #f8d7da;
        }

        .badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 3px;
            font-size: 0.85em;
            font-weight: bold;
            margin-left: 8px;
        }

        .badge-new {
            background: #28a745;
            color: white;
        }

        .badge-advanced {
            background: #ff6b6b;
            color: white;
        }

        .import-section .card {
            background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
        }
    </style>

        /* æ—¥å¿—æŸ¥çœ‹åŒºåŸŸæ ·å¼ */
        .log-container {
            background: #f8f9fa;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .log-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: bold;
        }

        .clear-log-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.4);
            color: white;
            padding: 5px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }

        .clear-log-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .log-content {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.6;
            max-height: 400px;
            overflow-y: auto;
            min-height: 200px;
        }

        /* è‡ªå®šä¹‰æ»šåŠ¨æ¡æ ·å¼ */
        .log-content::-webkit-scrollbar {
            width: 12px;
        }

        .log-content::-webkit-scrollbar-track {
            background: #2d2d2d;
            border-radius: 6px;
        }

        .log-content::-webkit-scrollbar-thumb {
            background: #667eea;
            border-radius: 6px;
        }

        .log-content::-webkit-scrollbar-thumb:hover {
            background: #764ba2;
        }

        .log-hint {
            color: #888;
            font-style: italic;
        }

        .log-entry {
            margin: 5px 0;
            padding: 5px;
            border-left: 3px solid #667eea;
            padding-left: 10px;
        }

        .log-entry.success {
            border-left-color: #28a745;
            color: #4dff4d;
        }

        .log-entry.info {
            border-left-color: #17a2b8;
            color: #4dd0e1;
        }

        .log-entry.warning {
            border-left-color: #ffc107;
            color: #ffd54f;
        }

        .log-entry.error {
            border-left-color: #dc3545;
            color: #ff6b6b;
        }
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš€ allbs-excel æµ‹è¯•å¹³å°</h1>
            <p>åŸºäº EasyExcel çš„ Spring Boot Excel å¯¼å…¥å¯¼å‡ºå¢å¼ºå·¥å…· v3.0.0</p>
        </div>

        <div class="content">
            <!-- åŸºæœ¬å¯¼å‡ºåŠŸèƒ½ -->
            <div class="section">
                <h2 class="section-title">ğŸ“¤ åŸºæœ¬å¯¼å‡ºåŠŸèƒ½</h2>
                <div class="card-grid">
                    <div class="card">
                        <h3>1. åŸºæœ¬å¯¼å‡º</h3>
                        <p>æœ€ç®€å•çš„å¯¼å‡ºæ–¹å¼ï¼Œè¿”å› List å³å¯è‡ªåŠ¨å¯¼å‡º Excel</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="simple-count" value="10" min="1" max="1000">
                            </div>
                            <button onclick="exportSimple()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>2. ç©ºæ•°æ®å¯¼å‡º <span class="badge badge-new">NEW</span></h3>
                        <p>å¯¼å‡ºåªæœ‰è¡¨å¤´çš„ç©º Excelï¼Œç”¨äºæ¨¡æ¿ä¸‹è½½</p>
                        <div class="card-controls">
                            <button onclick="exportEmpty()">å¯¼å‡ºç©ºè¡¨æ ¼</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>3. åªå¯¼å‡ºæ³¨è§£å­—æ®µ <span class="badge badge-new">NEW</span></h3>
                        <p>åªå¯¼å‡ºæ ‡æ³¨äº† @ExcelProperty çš„å­—æ®µ</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="annotated-count" value="10" min="1" max="1000">
                            </div>
                            <button onclick="exportOnlyAnnotated()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>4. å¤š Sheet å¯¼å‡º</h3>
                        <p>åœ¨ä¸€ä¸ª Excel æ–‡ä»¶ä¸­å¯¼å‡ºå¤šä¸ª Sheet</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>ç”¨æˆ·:</label>
                                <input type="number" id="multi-user" value="10" min="1" max="500">
                            </div>
                            <div class="input-group">
                                <label>è®¢å•:</label>
                                <input type="number" id="multi-order" value="20" min="1" max="500">
                            </div>
                            <button onclick="exportMultiSheet()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>5. å¤š Sheet ç©ºæ•°æ® <span class="badge badge-new">NEW</span></h3>
                        <p>å¯¼å‡ºå¤šä¸ª Sheetï¼Œæ¯ä¸ª Sheet éƒ½åªæœ‰è¡¨å¤´</p>
                        <div class="card-controls">
                            <button onclick="exportMultiSheetEmpty()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>6. åˆ—å®½å’Œè¡Œé«˜è®¾ç½®</h3>
                        <p>è‡ªå®šä¹‰åˆ—å®½å’Œè¡Œé«˜ï¼Œä¼˜åŒ–æ˜¾ç¤ºæ•ˆæœ</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="styled-count" value="15" min="1" max="1000">
                            </div>
                            <button onclick="exportStyled()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>7. åŠ¨æ€æ–‡ä»¶å</h3>
                        <p>ä½¿ç”¨ SpEL è¡¨è¾¾å¼åŠ¨æ€ç”Ÿæˆæ–‡ä»¶å</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ—¥æœŸ:</label>
                                <input type="date" id="dynamic-date" value="">
                            </div>
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="dynamic-count" value="10" min="1" max="1000">
                            </div>
                            <button onclick="exportDynamic()">å¯¼å‡º</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- é«˜çº§å¯¼å‡ºåŠŸèƒ½ -->
            <div class="section">
                <h2 class="section-title">ğŸ”¥ é«˜çº§å¯¼å‡ºåŠŸèƒ½</h2>
                <div class="card-grid">
                    <div class="card">
                        <h3>1. åˆå¹¶å•å…ƒæ ¼ <span class="badge badge-new">NEW</span></h3>
                        <p>è‡ªåŠ¨åˆå¹¶ç›¸åŒå€¼çš„å•å…ƒæ ¼ï¼Œæ”¯æŒä¾èµ–å…³ç³»åˆå¹¶</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="merge-count" value="20" min="1" max="1000">
                            </div>
                            <button onclick="exportMerge()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>2. æ•°æ®è„±æ• + å­—å…¸è½¬æ¢ <span class="badge badge-new">NEW</span></h3>
                        <p>æ”¯æŒæ‰‹æœºå·ã€èº«ä»½è¯ç­‰æ•æ„Ÿæ•°æ®è„±æ•ï¼Œå­—å…¸å€¼è‡ªåŠ¨è½¬æ¢</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="desensitize-count" value="10" min="1" max="1000">
                            </div>
                            <button onclick="exportDesensitize()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>3. å¯¼å‡ºè¿›åº¦å›è°ƒ <span class="badge badge-advanced">é«˜çº§</span></h3>
                        <p>å®æ—¶ç›‘å¬å¯¼å‡ºè¿›åº¦ï¼Œé€‚ç”¨äºå¤§æ•°æ®é‡å¯¼å‡ºï¼ˆæŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—ï¼‰</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="progress-count" value="5000" min="100" max="50000" step="100">
                            </div>
                            <button onclick="exportWithProgress()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>4. å¤§æ•°æ®é‡å¯¼å‡º <span class="badge badge-advanced">é«˜çº§</span></h3>
                        <p>æµ‹è¯•å¤§æ•°æ®é‡å¯¼å‡ºæ€§èƒ½ï¼ˆæŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—ï¼‰</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="large-count" value="20000" min="1000" max="100000" step="1000">
                            </div>
                            <button onclick="exportLargeData()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>5. åˆå¹¶ + è¿›åº¦ <span class="badge badge-advanced">é«˜çº§</span></h3>
                        <p>åˆå¹¶å•å…ƒæ ¼åŠŸèƒ½ç»“åˆè¿›åº¦å›è°ƒ</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="merge-progress-count" value="3000" min="100" max="30000" step="100">
                            </div>
                            <button onclick="exportMergeWithProgress()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>6. Excel å…¬å¼ <span class="badge badge-new">NEW</span></h3>
                        <p>æ”¯æŒå•å…ƒæ ¼å…¬å¼è‡ªåŠ¨è®¡ç®—ï¼ˆ=B*Cï¼‰</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="formula-count" value="10" min="1" max="1000">
                            </div>
                            <button onclick="exportFormula()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>7. å†»ç»“çª—æ ¼ + ç­›é€‰ <span class="badge badge-new">NEW</span></h3>
                        <p>å†»ç»“é¦–è¡Œã€è‡ªåŠ¨ç­›é€‰ã€åˆ—å®½è®¾ç½®</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="sheet-style-count" value="20" min="1" max="1000">
                            </div>
                            <button onclick="exportSheetStyle()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>8. æ¡ä»¶æ ¼å¼ï¼ˆå›¾æ ‡é›†ï¼‰ <span class="badge badge-new">NEW</span></h3>
                        <p>æ ¹æ®æ•°å€¼è‡ªåŠ¨æ˜¾ç¤ºå›¾æ ‡ï¼ˆçº¢ç»¿ç¯ã€ç®­å¤´ã€æ——å¸œï¼‰</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="conditional-format-count" value="15" min="1" max="1000">
                            </div>
                            <button onclick="exportConditionalFormat()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>9. å•å…ƒæ ¼æ‰¹æ³¨ <span class="badge badge-new">NEW</span></h3>
                        <p>ä¸ºè¡¨å¤´å’Œæ•°æ®å•å…ƒæ ¼æ·»åŠ æ‰¹æ³¨è¯´æ˜</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="comment-count" value="10" min="1" max="1000">
                            </div>
                            <button onclick="exportComment()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>10. å¯¼å…¥æ¨¡æ¿ç”Ÿæˆ <span class="badge badge-new">NEW</span></h3>
                        <p>ç”ŸæˆåŒ…å«ç¤ºä¾‹æ•°æ®çš„å¯¼å…¥æ¨¡æ¿</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>ç¤ºä¾‹è¡Œæ•°:</label>
                                <input type="number" id="template-samples" value="3" min="0" max="10">
                            </div>
                            <button onclick="exportTemplate()">ä¸‹è½½æ¨¡æ¿</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>11. Excel æ°´å° <span class="badge badge-new">NEW</span></h3>
                        <p>ä¸º Excel æ·»åŠ æ°´å°ä¿æŠ¤ï¼ˆæ”¯æŒè‡ªå®šä¹‰æ–‡æœ¬ã€é¢œè‰²ã€é€æ˜åº¦ï¼‰</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="watermark-count" value="30" min="1" max="1000">
                            </div>
                            <button onclick="exportWatermark()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>12. Excel å›¾è¡¨ <span class="badge badge-new">NEW</span></h3>
                        <p>åœ¨ Excel ä¸­è‡ªåŠ¨ç”Ÿæˆå›¾è¡¨ï¼ˆæŠ˜çº¿å›¾ã€æŸ±çŠ¶å›¾ç­‰ï¼‰</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æœˆä»½æ•°:</label>
                                <input type="number" id="chart-count" value="12" min="6" max="12">
                            </div>
                            <button onclick="exportChart()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>13. Excel åŠ å¯† <span class="badge badge-new">NEW</span></h3>
                        <p>å¯¼å‡ºåŠ å¯†çš„ Excel æ–‡ä»¶ï¼ˆAES-256 åŠ å¯†ï¼‰</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="encrypted-count" value="20" min="1" max="1000">
                            </div>
                            <div class="input-group">
                                <label>å¯†ç :</label>
                                <input type="text" id="encrypted-password" value="password123" style="width: 120px">
                            </div>
                            <button onclick="exportEncrypted()">å¯¼å‡º</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ’¡ æ–‡ä»¶åä¼šåŒ…å«å¯†ç ï¼Œè®°å¾—ç”¨å¯¹åº”å¯†ç æ‰“å¼€
                        </p>
                    </div>

                    <div class="card">
                        <h3>14. å›¾ç‰‡å¯¼å‡º <span class="badge badge-new">NEW</span></h3>
                        <p>æ”¯æŒå°†å›¾ç‰‡ï¼ˆURLã€æœ¬åœ°è·¯å¾„ã€å­—èŠ‚æ•°ç»„ï¼‰åµŒå…¥åˆ° Excel å•å…ƒæ ¼ä¸­</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="image-count" value="10" min="1" max="100">
                            </div>
                            <button onclick="exportImage()">å¯¼å‡º</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ’¡ æ¼”ç¤ºï¼šä¸»å›¾ã€ç¼©ç•¥å›¾åˆ—è¡¨ã€äºŒç»´ç ï¼ˆå­—èŠ‚æ•°ç»„ï¼‰
                        </p>
                    </div>
                </div>
            </div>

            <!-- å­—å…¸è½¬æ¢ç¤ºä¾‹ -->
            <div class="section">
                <h2 class="section-title">ğŸ“– å­—å…¸è½¬æ¢ç¤ºä¾‹</h2>
                <div class="card-grid">
                    <div class="card">
                        <h3>1. å¯¼å‡ºå­—å…¸è½¬æ¢ <span class="badge badge-new">NEW</span></h3>
                        <p>æ•°æ®åº“å€¼(0/1/2) â†’ Excelæ ‡ç­¾(å¥³/ç”·/æœªçŸ¥)</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="dict-export-count" value="10" min="1" max="100">
                            </div>
                            <button onclick="exportDictExample()">å¯¼å‡ºç¤ºä¾‹</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>2. ä¸‹è½½å­—å…¸æ¨¡æ¿ <span class="badge badge-new">NEW</span></h3>
                        <p>ä¸‹è½½åŒ…å«å­—å…¸è½¬æ¢ç¤ºä¾‹çš„æ¨¡æ¿æ–‡ä»¶</p>
                        <div class="card-controls">
                            <button onclick="downloadDictTemplate()">ä¸‹è½½æ¨¡æ¿</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>3. å¯¼å…¥å­—å…¸è½¬æ¢ <span class="badge badge-new">NEW</span></h3>
                        <p>Excelæ ‡ç­¾(å¥³/ç”·/æœªçŸ¥) â†’ æ•°æ®åº“å€¼(0/1/2)</p>
                        <div class="card-controls">
                            <input type="file" id="dict-import-file" class="file-input" accept=".xlsx,.xls">
                            <label for="dict-import-file" class="file-label">é€‰æ‹©æ–‡ä»¶</label>
                            <button class="upload-btn" onclick="importDictExample()">ä¸Šä¼ å¯¼å…¥</button>
                        </div>
                        <div id="dict-import-result"></div>
                    </div>

                    <div class="card">
                        <h3>4. æŸ¥çœ‹å­—å…¸é…ç½® <span class="badge badge-new">NEW</span></h3>
                        <p>æŸ¥çœ‹ç³»ç»Ÿä¸­é…ç½®çš„æ‰€æœ‰å­—å…¸</p>
                        <div class="card-controls">
                            <button onclick="viewDictConfig()">æŸ¥çœ‹é…ç½®</button>
                        </div>
                        <div id="dict-config-result"></div>
                    </div>
                </div>
            </div>

            <!-- å¯¼å…¥åŠŸèƒ½ -->
            <div class="section import-section">
                <h2 class="section-title">ğŸ“¥ å¯¼å…¥åŠŸèƒ½æµ‹è¯•</h2>
                <div class="card-grid">
                    <div class="card">
                        <h3>0. ä¸‹è½½å¯¼å…¥æ¨¡æ¿ <span class="badge badge-new">NEW</span></h3>
                        <p>ä¸‹è½½æ ‡å‡†æ ¼å¼çš„å¯¼å…¥æ¨¡æ¿ï¼ˆåŒ…å«ç¤ºä¾‹æ•°æ®ï¼‰</p>
                        <div class="card-controls">
                            <button onclick="downloadTemplate()">ä¸‹è½½æ¨¡æ¿</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>1. åŸºæœ¬å¯¼å…¥</h3>
                        <p>ä¸Šä¼  Excel æ–‡ä»¶ï¼Œè‡ªåŠ¨è§£æä¸º Java å¯¹è±¡</p>
                        <div class="card-controls">
                            <input type="file" id="simple-import-file" class="file-input" accept=".xlsx,.xls">
                            <label for="simple-import-file" class="file-label">é€‰æ‹©æ–‡ä»¶</label>
                            <button class="upload-btn" onclick="importSimple()">ä¸Šä¼ å¯¼å…¥</button>
                        </div>
                        <div id="simple-import-result"></div>
                    </div>

                    <div class="card">
                        <h3>2. å¸¦éªŒè¯çš„å¯¼å…¥</h3>
                        <p>å¯¼å…¥æ—¶è‡ªåŠ¨è¿›è¡Œæ•°æ®æ ¡éªŒï¼ˆJSR-303ï¼‰</p>
                        <div class="card-controls">
                            <input type="file" id="validate-import-file" class="file-input" accept=".xlsx,.xls">
                            <label for="validate-import-file" class="file-label">é€‰æ‹©æ–‡ä»¶</label>
                            <button class="upload-btn" onclick="importValidate()">ä¸Šä¼ å¯¼å…¥</button>
                        </div>
                        <div id="validate-import-result"></div>
                    </div>

                    <div class="card">
                        <h3>3. è·³è¿‡ç©ºè¡Œå¯¼å…¥</h3>
                        <p>å¯¼å…¥æ—¶è‡ªåŠ¨è·³è¿‡ç©ºè¡Œ</p>
                        <div class="card-controls">
                            <input type="file" id="skip-import-file" class="file-input" accept=".xlsx,.xls">
                            <label for="skip-import-file" class="file-label">é€‰æ‹©æ–‡ä»¶</label>
                            <button class="upload-btn" onclick="importSkipEmpty()">ä¸Šä¼ å¯¼å…¥</button>
                        </div>
                        <div id="skip-import-result"></div>
                    </div>
                </div>
            </div>

            <!-- åµŒå¥—å¯¹è±¡å¯¼å‡ºåŠŸèƒ½ -->
            <div class="section">
                <h2 class="section-title">ğŸ†• åµŒå¥—å¯¹è±¡å¯¼å‡ºåŠŸèƒ½ <span class="badge badge-new">NEW</span></h2>
                <div class="card-grid">
                    <div class="card">
                        <h3>1. @NestedProperty - åµŒå¥—å¯¹è±¡å­—æ®µæå–</h3>
                        <p>ä»åµŒå¥—å¯¹è±¡ã€é›†åˆã€Map ä¸­æå–æŒ‡å®šå­—æ®µå€¼å¯¼å‡º</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="nested-property-count" value="10" min="1" max="100">
                            </div>
                            <button onclick="exportNestedProperty()">å¯¼å‡º</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ’¡ æ¼”ç¤ºï¼šæå–éƒ¨é—¨åç§°ã€é¢†å¯¼ç”µè¯ã€æŠ€èƒ½åˆ—è¡¨ã€Mapä¸­çš„åŸå¸‚ç­‰
                        </p>
                    </div>

                    <div class="card">
                        <h3>2. @FlattenProperty - åµŒå¥—å¯¹è±¡è‡ªåŠ¨å±•å¼€</h3>
                        <p>è‡ªåŠ¨å±•å¼€åµŒå¥—å¯¹è±¡çš„æ‰€æœ‰ @ExcelProperty å­—æ®µ</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="flatten-property-count" value="10" min="1" max="100">
                            </div>
                            <button onclick="exportFlattenProperty()">å¯¼å‡º</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ’¡ æ¼”ç¤ºï¼šè‡ªåŠ¨å±•å¼€éƒ¨é—¨å¯¹è±¡çš„æ‰€æœ‰å­—æ®µï¼Œæ”¯æŒå‰ç¼€å’Œé€’å½’å±•å¼€
                        </p>
                    </div>

                    <div class="card">
                        <h3>3. @FlattenList - è®¢å•æ˜ç»†å±•å¼€</h3>
                        <p>å°†è®¢å•çš„ List&lt;OrderItem&gt; å±•å¼€ä¸ºå¤šè¡Œï¼Œè‡ªåŠ¨åˆå¹¶å•å…ƒæ ¼</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>è®¢å•æ•°:</label>
                                <input type="number" id="flatten-list-order-count" value="5" min="1" max="20">
                            </div>
                            <button onclick="exportFlattenListOrder()">å¯¼å‡º</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ’¡ æ¼”ç¤ºï¼šä¸€ä¸ªè®¢å•æœ‰å¤šä¸ªå•†å“æ˜ç»†ï¼Œå±•å¼€ä¸ºå¤šè¡Œå¹¶è‡ªåŠ¨åˆå¹¶
                        </p>
                    </div>

                    <div class="card">
                        <h3>4. @FlattenList - å­¦ç”Ÿå¤š List å±•å¼€</h3>
                        <p>å­¦ç”Ÿæœ‰å¤šä¸ªè¯¾ç¨‹å’Œå¤šä¸ªå¥–é¡¹ï¼Œå±•å¼€ä¸ºå¤šè¡Œï¼ˆå–æœ€é•¿ç­–ç•¥ï¼‰</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>å­¦ç”Ÿæ•°:</label>
                                <input type="number" id="flatten-list-student-count" value="5" min="1" max="20">
                            </div>
                            <button onclick="exportFlattenListStudent()">å¯¼å‡º</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ’¡ æ¼”ç¤ºï¼šå¤šä¸ª List å­—æ®µåŒæ—¶å±•å¼€ï¼ŒæŒ‰æœ€é•¿ List çš„é•¿åº¦å±•å¼€
                        </p>
                    </div>

                    <div class="card">
                        <h3>5. @ConditionalStyle - æ¡ä»¶æ ·å¼</h3>
                        <p>æ ¹æ®å•å…ƒæ ¼å€¼è‡ªåŠ¨åº”ç”¨ä¸åŒæ ·å¼ï¼ˆé¢œè‰²ã€å­—ä½“ç­‰ï¼‰</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="conditional-style-count" value="20" min="1" max="100">
                            </div>
                            <button onclick="exportConditionalStyle()">å¯¼å‡º</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ’¡ æ¼”ç¤ºï¼šåˆ†æ•°>=90ç»¿è‰²ã€>=60é»„è‰²ã€<60çº¢è‰²ï¼›çŠ¶æ€ä¸åŒé¢œè‰²
                        </p>
                    </div>

                    <div class="card">
                        <h3>6. @DynamicHeaders - åŠ¨æ€è¡¨å¤´</h3>
                        <p>æ ¹æ®æ•°æ®åŠ¨æ€ç”Ÿæˆè¡¨å¤´åˆ—ï¼ˆé€‚ç”¨äºå±æ€§ä¸å›ºå®šçš„åœºæ™¯ï¼‰</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="dynamic-header-count" value="15" min="1" max="100">
                            </div>
                            <button onclick="exportDynamicHeader()">å¯¼å‡º</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ’¡ æ¼”ç¤ºï¼šä¸åŒäº§å“ç±»åˆ«æœ‰ä¸åŒå±æ€§ï¼Œè¡¨å¤´è‡ªåŠ¨ç”Ÿæˆ
                        </p>
                    </div>
                </div>
            </div>

            <!-- åµŒå¥—å¯¹è±¡å¯¼å…¥åŠŸèƒ½ -->
            <div class="section">
                <h2 class="section-title">ğŸ“¥ åµŒå¥—å¯¹è±¡å¯¼å…¥åŠŸèƒ½ <span class="badge badge-new">NEW</span></h2>
                <div class="card-grid">
                    <div class="card">
                        <h3>1. @NestedProperty - åµŒå¥—å¯¹è±¡å¯¼å…¥</h3>
                        <p>å¯¼å…¥Excelæ—¶è‡ªåŠ¨å¡«å……åµŒå¥—å¯¹è±¡å­—æ®µ</p>
                        <div class="card-controls">
                            <input type="file" id="nested-property-import-file" class="file-input" accept=".xlsx,.xls">
                            <label for="nested-property-import-file" class="file-label">é€‰æ‹©æ–‡ä»¶</label>
                            <button class="upload-btn" onclick="importNestedProperty()">ä¸Šä¼ å¯¼å…¥</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ’¡ å…ˆå¯¼å‡ºä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åå¯ä»¥å°è¯•å¯¼å…¥
                        </p>
                        <div id="nested-property-import-result" style="margin-top: 10px;"></div>
                    </div>

                    <div class="card">
                        <h3>2. @FlattenList - å¤šè¡Œèšåˆå¯¼å…¥</h3>
                        <p>å°†å¤šè¡Œæ˜ç»†æ•°æ®èšåˆå›Listå¯¹è±¡</p>
                        <div class="card-controls">
                            <input type="file" id="flatten-list-import-file" class="file-input" accept=".xlsx,.xls">
                            <label for="flatten-list-import-file" class="file-label">é€‰æ‹©æ–‡ä»¶</label>
                            <button class="upload-btn" onclick="importFlattenListOrder()">ä¸Šä¼ å¯¼å…¥</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ’¡ å…ˆå¯¼å‡ºè®¢å•æ˜ç»†ï¼Œç„¶åå¯¼å…¥æµ‹è¯•èšåˆåŠŸèƒ½
                        </p>
                        <div id="flatten-list-import-result" style="margin-top: 10px;"></div>
                    </div>
                </div>
            </div>

            <!-- æ•°æ®éªŒè¯åŠŸèƒ½ -->
            <div class="section">
                <h2 class="section-title">âœ… æ•°æ®éªŒè¯åŠŸèƒ½ <span class="badge badge-new">NEW</span></h2>
                <div class="card-grid">
                    <div class="card">
                        <h3>1. @ExcelValidation - åŸºç¡€æ•°æ®éªŒè¯</h3>
                        <p>ä¸º Excel åˆ—æ·»åŠ æ•°æ®éªŒè¯è§„åˆ™ï¼ˆä¸‹æ‹‰åˆ—è¡¨ã€æ•°å€¼èŒƒå›´ã€æ—¥æœŸã€æ–‡æœ¬é•¿åº¦ç­‰ï¼‰</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="validation-count" value="10" min="1" max="100">
                            </div>
                            <button onclick="exportValidation()">å¯¼å‡º</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ’¡ æ¼”ç¤ºï¼šæ€§åˆ«ä¸‹æ‹‰ã€å¹´é¾„èŒƒå›´18-65ã€å·¥èµ„èŒƒå›´ã€æ—¥æœŸéªŒè¯ã€æ–‡æœ¬é•¿åº¦ç­‰
                        </p>
                    </div>

                    <div class="card">
                        <h3>2. @ExcelValidation - è‡ªå®šä¹‰éªŒè¯èŒƒå›´</h3>
                        <p>è‡ªå®šä¹‰æ•°æ®éªŒè¯çš„è¡ŒèŒƒå›´ï¼ˆé€‚ç”¨äºä¸åŒä¸šåŠ¡åœºæ™¯ï¼‰</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>æ•°æ®é‡:</label>
                                <input type="number" id="validation-custom-count" value="10" min="1" max="100">
                            </div>
                            <button onclick="exportValidationCustom()">å¯¼å‡º</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ’¡ æ¼”ç¤ºï¼šéªŒè¯èŒƒå›´ä»ç¬¬2è¡Œåˆ°ç¬¬1000è¡Œï¼ˆæ”¯æŒå¤§æ•°æ®é‡ï¼‰
                        </p>
                    </div>
                </div>
            </div>

            <!-- å¤š Sheet å…³è”å¯¼å‡ºåŠŸèƒ½ -->
            <div class="section">
                <h2 class="section-title">ğŸ”— å¤š Sheet å…³è”å¯¼å‡º <span class="badge badge-new">NEW</span></h2>
                <div class="card-grid">
                    <div class="card">
                        <h3>1. @RelatedSheet - å…³è” Sheet å¯¼å‡º</h3>
                        <p>å°†ä¸»è¡¨å’Œå…³è”æ˜ç»†å¯¼å‡ºåˆ°ä¸åŒ Sheetï¼Œè‡ªåŠ¨å»ºç«‹å…³è”å…³ç³»</p>
                        <div class="card-controls">
                            <div class="input-group">
                                <label>è®¢å•æ•°:</label>
                                <input type="number" id="multi-sheet-count" value="5" min="1" max="20">
                            </div>
                            <button onclick="exportMultiSheet()">å¯¼å‡º</button>
                        </div>
                        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">
                            ğŸ’¡ æ¼”ç¤ºï¼šè®¢å•ä¸»è¡¨å’Œè®¢å•æ˜ç»†åˆ†åˆ«å¯¼å‡ºåˆ°ä¸åŒ Sheetï¼Œå¹¶åˆ›å»ºå…³è”
                        </p>
                    </div>
                </div>
            </div>
        </div>

            <!-- å¯¼å‡ºè¿›åº¦æ—¥å¿—æŸ¥çœ‹åŒºåŸŸ -->
            <div class="section" style="margin-top: 40px;">
                <h2 class="section-title">ğŸ“Š å¯¼å‡ºè¿›åº¦æ—¥å¿— <span class="badge badge-info">å®æ—¶</span></h2>
                <div class="log-container" id="export-log-container">
                    <div class="log-header">
                        <span>åç«¯å¯¼å‡ºè¿›åº¦æ—¥å¿— (è‡ªåŠ¨åˆ·æ–°)</span>
                        <button onclick="clearLog()" class="clear-log-btn">æ¸…ç©ºæ—¥å¿—</button>
                    </div>
                    <div class="log-content" id="export-log">
                        <div class="log-hint">ğŸ’¡ æç¤º: ç‚¹å‡»ä¸Šæ–¹ "å¯¼å‡ºè¿›åº¦å›è°ƒ"ã€"å¤§æ•°æ®é‡å¯¼å‡º" æˆ– "åˆå¹¶ + è¿›åº¦" æŒ‰é’®åï¼Œæ­¤å¤„å°†æ˜¾ç¤ºåç«¯å¯¼å‡ºè¿›åº¦æ—¥å¿—</div>
                    </div>
                </div>
            </div>
    </div>

    <script>
        // è®¾ç½®é»˜è®¤æ—¥æœŸ
        document.getElementById('dynamic-date').valueAsDate = new Date();

        const API_BASE = 'http://localhost:8080';

        // å¯¼å‡ºå‡½æ•°
        function exportSimple() {
            const count = document.getElementById('simple-count').value;
            window.open(`${API_BASE}/api/export/basic/simple?count=${count}`);
        }

        function exportEmpty() {
            window.open(`${API_BASE}/api/export/basic/empty`);
        }

        function exportOnlyAnnotated() {
            const count = document.getElementById('annotated-count').value;
            window.open(`${API_BASE}/api/export/basic/only-annotated?count=${count}`);
        }

        function exportMultiSheet() {
            const userCount = document.getElementById('multi-user').value;
            const orderCount = document.getElementById('multi-order').value;
            window.open(`${API_BASE}/api/export/basic/multi-sheet?userCount=${userCount}&orderCount=${orderCount}`);
        }

        function exportMultiSheetEmpty() {
            window.open(`${API_BASE}/api/export/basic/multi-sheet-empty`);
        }

        function exportStyled() {
            const count = document.getElementById('styled-count').value;
            window.open(`${API_BASE}/api/export/basic/styled?count=${count}`);
        }

        function exportDynamic() {
            const date = document.getElementById('dynamic-date').value;
            const count = document.getElementById('dynamic-count').value;
            window.open(`${API_BASE}/api/export/basic/dynamic-name?date=${date}&count=${count}`);
        }

        // ä¸‹è½½å¯¼å…¥æ¨¡æ¿
        function downloadTemplate() {
            window.open(`${API_BASE}/api/import/template`);
        }

        function exportMerge() {
            const count = document.getElementById('merge-count').value;
            window.open(`${API_BASE}/api/export/advanced/merge?count=${count}`);
        }

        function exportDesensitize() {
            const count = document.getElementById('desensitize-count').value;
            window.open(`${API_BASE}/api/export/advanced/desensitize?count=${count}`);
        }

        function exportWithProgress() {
            const count = document.getElementById('progress-count').value;
            addLog('å¼€å§‹å¯¼å‡º ' + count + ' æ¡æ•°æ®ï¼Œè¯·æŸ¥çœ‹åç«¯æ§åˆ¶å°è·å–è¯¦ç»†è¿›åº¦...', 'info');
            window.open(`${API_BASE}/api/export/advanced/with-progress?count=${count}`);
        }

        function exportLargeData() {
            const count = document.getElementById('large-count').value;
            console.log('å¼€å§‹å¤§æ•°æ®é‡å¯¼å‡ºï¼Œè¯·æŸ¥çœ‹åç«¯æ§åˆ¶å°æ—¥å¿—...');
            window.open(`${API_BASE}/api/export/advanced/large-data?count=${count}`);
        }

        function exportMergeWithProgress() {
            const count = document.getElementById('merge-progress-count').value;
            addLog('å¼€å§‹å¯¼å‡º ' + count + ' æ¡æ•°æ®ï¼Œè¯·æŸ¥çœ‹åç«¯æ§åˆ¶å°è·å–è¯¦ç»†è¿›åº¦...', 'info');
            window.open(`${API_BASE}/api/export/advanced/merge-with-progress?count=${count}`);
        }

        // å¯¼å…¥å‡½æ•°
        function importSimple() {
            uploadFile('simple-import-file', '/api/import/simple', 'simple-import-result');
        }

        function importValidate() {
            uploadFile('validate-import-file', '/api/import/validate', 'validate-import-result');
        }

        function importSkipEmpty() {
            uploadFile('skip-import-file', '/api/import/skip-empty', 'skip-import-result');
        }

        // å­—å…¸è½¬æ¢ç¤ºä¾‹å‡½æ•°
        function exportDictExample() {
            const count = document.getElementById('dict-export-count').value;
            window.open(`${API_BASE}/api/dict/export?count=${count}`);
        }

        function downloadDictTemplate() {
            window.open(`${API_BASE}/api/dict/template`);
        }

        function importDictExample() {
            uploadFile('dict-import-file', '/api/dict/import', 'dict-import-result');
        }

        function viewDictConfig() {
            fetch(`${API_BASE}/api/dict/config`)
                .then(response => response.json())
                .then(data => {
                    let html = '<div class="result-content">';
                    html += '<h4>å­—å…¸é…ç½®ä¿¡æ¯ï¼š</h4>';
                    html += '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
                    html += '</div>';
                    document.getElementById('dict-config-result').innerHTML = html;
                })
                .catch(error => {
                    showResult('dict-config-result', 'è·å–å­—å…¸é…ç½®å¤±è´¥: ' + error.message, 'error');
                });
        }

        function uploadFile(fileInputId, apiUrl, resultId) {
            const fileInput = document.getElementById(fileInputId);
            const file = fileInput.files[0];

            if (!file) {
                showResult(resultId, 'è¯·å…ˆé€‰æ‹©æ–‡ä»¶', 'error');
                return;
            }

            const formData = new FormData();
            formData.append('file', file);

            fetch(API_BASE + apiUrl, {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showResult(resultId,
                        `âœ… ${data.message}<br>å¯¼å…¥æ•°æ®é‡: ${data.count} æ¡<br>` +
                        `<pre>${JSON.stringify(data.data, null, 2)}</pre>`,
                        'success'
                    );
                } else {
                    showResult(resultId,
                        `âŒ ${data.message}<br>é”™è¯¯è¯¦æƒ…: ${data.errors.join('<br>')}`,
                        'error'
                    );
                }
            })
            .catch(error => {
                showResult(resultId, `âŒ ä¸Šä¼ å¤±è´¥: ${error.message}`, 'error');
            });
        }

        function showResult(elementId, message, type) {
            const resultDiv = document.getElementById(elementId);
            resultDiv.className = `result ${type}`;
            resultDiv.innerHTML = message;
        }

        // ==================== åµŒå¥—å¯¹è±¡å¯¼å‡ºå‡½æ•° ====================

        function exportNestedProperty() {
            const count = document.getElementById('nested-property-count').value;
            window.open(`${API_BASE}/api/export/nested/nested-property?count=${count}`);
        }

        function exportFlattenProperty() {
            const count = document.getElementById('flatten-property-count').value;
            window.open(`${API_BASE}/api/export/nested/flatten-property?count=${count}`);
        }

        function exportFlattenListOrder() {
            const count = document.getElementById('flatten-list-order-count').value;
            window.open(`${API_BASE}/api/export/nested/flatten-list-order?count=${count}`);
        }

        function exportFlattenListStudent() {
            const count = document.getElementById('flatten-list-student-count').value;
            window.open(`${API_BASE}/api/export/nested/flatten-list-student?count=${count}`);
        }

        function exportConditionalStyle() {
            const count = document.getElementById('conditional-style-count').value;
            window.open(`${API_BASE}/api/export/nested/conditional-style?count=${count}`);
        }

        function exportDynamicHeader() {
            const count = document.getElementById('dynamic-header-count').value;
            window.open(`${API_BASE}/api/export/nested/dynamic-header?count=${count}`);
        }

        // å¯¼å…¥å‡½æ•°
        function importNestedProperty() {
            const fileInput = document.getElementById('nested-property-import-file');
            const resultDiv = document.getElementById('nested-property-import-result');

            if (!fileInput.files || fileInput.files.length === 0) {
                resultDiv.innerHTML = '<p style="color: red;">è¯·å…ˆé€‰æ‹©æ–‡ä»¶</p>';
                return;
            }

            const formData = new FormData();
            formData.append('file', fileInput.files[0]);

            resultDiv.innerHTML = '<p style="color: blue;">å¯¼å…¥ä¸­...</p>';

            fetch(`${API_BASE}/api/import/nested/nested-property`, {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    resultDiv.innerHTML = `
                        <p style="color: green;">âœ“ ${data.message}</p>
                        <pre style="max-height: 200px; overflow: auto; font-size: 0.85em;">${JSON.stringify(data.data, null, 2)}</pre>
                    `;
                } else {
                    resultDiv.innerHTML = `<p style="color: red;">âœ— å¯¼å…¥å¤±è´¥ï¼š${data.message}</p>`;
                }
            })
            .catch(error => {
                resultDiv.innerHTML = `<p style="color: red;">âœ— å¯¼å…¥å¤±è´¥ï¼š${error.message}</p>`;
            });
        }

        function importFlattenListOrder() {
            const fileInput = document.getElementById('flatten-list-import-file');
            const resultDiv = document.getElementById('flatten-list-import-result');

            if (!fileInput.files || fileInput.files.length === 0) {
                resultDiv.innerHTML = '<p style="color: red;">è¯·å…ˆé€‰æ‹©æ–‡ä»¶</p>';
                return;
            }

            const formData = new FormData();
            formData.append('file', fileInput.files[0]);

            resultDiv.innerHTML = '<p style="color: blue;">å¯¼å…¥ä¸­...</p>';

            fetch(`${API_BASE}/api/import/nested/flatten-list-order`, {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    resultDiv.innerHTML = `
                        <p style="color: green;">âœ“ ${data.message}</p>
                        <pre style="max-height: 200px; overflow: auto; font-size: 0.85em;">${JSON.stringify(data.data, null, 2)}</pre>
                    `;
                } else {
                    resultDiv.innerHTML = `<p style="color: red;">âœ— å¯¼å…¥å¤±è´¥ï¼š${data.message}</p>`;
                }
            })
            .catch(error => {
                resultDiv.innerHTML = `<p style="color: red;">âœ— å¯¼å…¥å¤±è´¥ï¼š${error.message}</p>`;
            });
        }

        // æ•°æ®éªŒè¯å¯¼å‡ºå‡½æ•°
        function exportValidation() {
            const count = document.getElementById('validation-count').value;
            window.location.href = `${API_BASE}/api/export/advanced/validation?count=${count}`;
        }

        function exportValidationCustom() {
            const count = document.getElementById('validation-custom-count').value;
            window.location.href = `${API_BASE}/api/export/advanced/validation-custom?count=${count}`;
        }

        // å¤š Sheet å…³è”å¯¼å‡ºå‡½æ•°
        function exportMultiSheet() {
            const count = document.getElementById('multi-sheet-count').value;
            window.location.href = `${API_BASE}/api/export/advanced/multi-sheet?count=${count}`;
        }

        // ==================== æ–°åŠŸèƒ½å¯¼å‡ºå‡½æ•° ====================

        // Excel å…¬å¼å¯¼å‡º
        function exportFormula() {
            const count = document.getElementById('formula-count').value;
            window.location.href = `${API_BASE}/api/export/advanced/formula?count=${count}`;
        }

        // å†»ç»“çª—æ ¼å’Œç­›é€‰å¯¼å‡º
        function exportSheetStyle() {
            const count = document.getElementById('sheet-style-count').value;
            window.location.href = `${API_BASE}/api/export/advanced/sheet-style?count=${count}`;
        }

        // æ¡ä»¶æ ¼å¼å¯¼å‡º
        function exportConditionalFormat() {
            const count = document.getElementById('conditional-format-count').value;
            window.location.href = `${API_BASE}/api/export/advanced/conditional-format?count=${count}`;
        }

        // å•å…ƒæ ¼æ‰¹æ³¨å¯¼å‡º
        function exportComment() {
            const count = document.getElementById('comment-count').value;
            window.location.href = `${API_BASE}/api/export/advanced/comment?count=${count}`;
        }

        // å¯¼å…¥æ¨¡æ¿ç”Ÿæˆ
        function exportTemplate() {
            const sampleRows = document.getElementById('template-samples').value;
            window.location.href = `${API_BASE}/api/export/advanced/template?sampleRows=${sampleRows}`;
        }

        // Excel æ°´å°å¯¼å‡º
        function exportWatermark() {
            const count = document.getElementById('watermark-count').value;
            window.location.href = `${API_BASE}/api/export/advanced/watermark?count=${count}`;
        }

        // Excel å›¾è¡¨å¯¼å‡º
        function exportChart() {
            const count = document.getElementById('chart-count').value;
            window.location.href = `${API_BASE}/api/export/advanced/chart?count=${count}`;
        }

        // Excel åŠ å¯†å¯¼å‡º
        function exportEncrypted() {
            const count = document.getElementById('encrypted-count').value;
            const password = document.getElementById('encrypted-password').value;
            window.location.href = `${API_BASE}/api/export/advanced/encrypted?count=${count}&password=${password}`;
        }

        // å›¾ç‰‡å¯¼å‡º
        function exportImage() {
            const count = document.getElementById('image-count').value;
            window.location.href = `${API_BASE}/api/export/advanced/image?count=${count}`;
        }
    </script>

        // æ—¥å¿—ç®¡ç†å‡½æ•°
        function clearLog() {
            const logDiv = document.getElementById('export-log');
            logDiv.innerHTML = '<div class="log-hint">ğŸ’¡ æç¤º: ç‚¹å‡»ä¸Šæ–¹ "å¯¼å‡ºè¿›åº¦å›è°ƒ"ã€"å¤§æ•°æ®é‡å¯¼å‡º" æˆ– "åˆå¹¶ + è¿›åº¦" æŒ‰é’®åï¼Œæ­¤å¤„å°†æ˜¾ç¤ºåç«¯å¯¼å‡ºè¿›åº¦æ—¥å¿—</div>';
        }

        function addLog(message, type = 'info') {
            const logDiv = document.getElementById('export-log');
            
            // ç§»é™¤æç¤ºä¿¡æ¯
            const hint = logDiv.querySelector('.log-hint');
            if (hint) {
                hint.remove();
            }

            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry ${type}`;
            logEntry.textContent = `[${timestamp}] ${message}`;
            
            logDiv.appendChild(logEntry);
            
            // è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨
            logDiv.scrollTop = logDiv.scrollHeight;
        }
</body>
</html>
